<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Model formulation &mdash; EnergyScope_documentation 2.2 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=f35be339"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Input Data - Colombia" href="Input%20Data%20-%20Colombia.html" />
    <link rel="prev" title="How to contribute" href="How%20to%20contribute.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            EnergyScope_documentation
              <img src="../_static/estd_graphical_abstract.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="Releases.html">Releases</a></li>
<li class="toctree-l1"><a class="reference internal" href="Getting%20started.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="How%20to%20contribute.html">How to contribute</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Model formulation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="#typical-days-selection">Typical days selection</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#clustering-methods">Clustering methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="#implementing-seasonality-with-typical-days">Implementing seasonality with typical days</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#energy-system-model">Energy system model</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#linear-programming-formulation">Linear programming formulation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#conceptual-modelling-framework">Conceptual modelling framework</a></li>
<li class="toctree-l3"><a class="reference internal" href="#sets-parameters-and-variables">Sets, parameters and variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="#energy-model-formulation">Energy model formulation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#end-use-demand">End-use demand</a></li>
<li class="toctree-l4"><a class="reference internal" href="#cost-emissions-and-objective-function">Cost, emissions and objective function</a></li>
<li class="toctree-l4"><a class="reference internal" href="#system-design-and-operation">System design and operation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#storage">Storage</a></li>
<li class="toctree-l4"><a class="reference internal" href="#networks">Networks</a></li>
<li class="toctree-l4"><a class="reference internal" href="#additional-constraints">Additional Constraints</a></li>
<li class="toctree-l4"><a class="reference internal" href="#decentralised-heat-production">Decentralised heat production</a></li>
<li class="toctree-l4"><a class="reference internal" href="#vehicle-to-grid">Vehicle-to-grid</a></li>
<li class="toctree-l4"><a class="reference internal" href="#peak-demand">Peak demand</a></li>
<li class="toctree-l4"><a class="reference internal" href="#adaptations-for-the-case-study">Adaptations for the case study</a></li>
<li class="toctree-l4"><a class="reference internal" href="#additional-contraints-on-imports-exports-and-renewables">Additional contraints on imports, exports and renewables</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#implementation">Implementation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Input%20Data%20-%20Colombia.html">Input Data - Colombia</a></li>
<li class="toctree-l1"><a class="reference internal" href="Input%20Data%20-%20Turkey.html">Input Data - Turkey</a></li>
<li class="toctree-l1"><a class="reference internal" href="Bibliography.html">Bibliography</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">EnergyScope_documentation</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Model formulation</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/sections/Model formulation.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="model-formulation">
<span id="ch-estd"></span><h1>Model formulation<a class="headerlink" href="#model-formulation" title="Link to this heading"></a></h1>
<p><strong>Model overview:</strong></p>
<figure class="align-default" id="fig-ch2-overview">
<img alt="Overview of the LP modeling framework" src="../_images/chp_estd_overview.png" />
<figcaption>
<p><span class="caption-number">Fig. 3 </span><span class="caption-text">Overview of the LP modelling framework.</span><a class="headerlink" href="#fig-ch2-overview" title="Link to this image"></a></p>
</figcaption>
</figure>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading"></a></h2>
<p>Due to computational restrictions, energy system models rarely optimise over
the 8760 hours of the year. For example, running our model with 8760h time
series takes more than 19 hours, while it takes only around 1 minute with the
methodology presented hereafter.</p>
<p>A typical solution is to use a
subset of Typical (i.e. representative) Days called TD; this is a trade-off between
introducing an approximation error in the representation of the energy
system (especially for short-term dynamics) and computational time.</p>
<p>Running the EnergyScope Typical Day (ESTD) model consists in two steps:</p>
<ul class="simple">
<li><p>the first step consists in pre-processing the time series and solving
a MILP problem to determine the adequate set of typical days (<a class="reference internal" href="#sec-td-selection"><span class="std std-ref">Typical days selection</span></a>).</p></li>
<li><p>the second step is the main energy model: the optimal
design and operation of the energy system over the selected typical days is computed i.e. technology selection, sizing and operation
for a target future year (<a class="reference internal" href="#sec-estd"><span class="std std-ref">Energy system model</span></a>)</p></li>
</ul>
<p>These two steps can be performed independently. Usually, the first step
is computed only once for an energy system with given weather data whereas
the second step is computed several times (once for each different
scenario). <a class="reference internal" href="#fig-processstructure"><span class="std std-numref">Figure 4</span></a>  illustrates the overall structure of the code.</p>
<figure class="align-default" id="fig-processstructure">
<img alt="Overview of the EnergyScope TD framework in two-steps." src="../_images/meth_process_structure.png" />
<figcaption>
<p><span class="caption-number">Fig. 4 </span><span class="caption-text">Overview of the EnergyScope TD framework in two-steps. <strong>STEP 1</strong>:
optimal selection of typical days (<a class="reference internal" href="#sec-td-selection"><span class="std std-ref">Typical days selection</span></a>). <strong>STEP 2</strong>:
Energy system model (<a class="reference internal" href="#sec-estd"><span class="std std-ref">Energy system model</span></a>). The first step processes
only a subset of parameters, which account for the 8760h time series.
Abbreviations: Typical Day (TD), Linear Programming (LP), Mixed Integer Linear Programming (MILP), Global Warming Potential (GWP).</span><a class="headerlink" href="#fig-processstructure" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>This documentation is built based on previous works <span id="id1"><sup><a class="reference internal" href="Bibliography.html#id57" title="Gauthier Limpens. Generating energy transition pathways: application to Belgium. PhD thesis, UCLouvain, 2021. doi:10.13140/RG.2.2.25755.18724.">1</a>,<a class="reference internal" href="Bibliography.html#id58" title="Gauthier Limpens, Stefano Moret, Hervé Jeanmart, and Francois Maréchal. EnergyScope TD: A novel open-source model for regional energy systems. Applied Energy, 255(March):113729, 2019.">2</a>,<a class="reference internal" href="Bibliography.html#id56" title="Stefano Moret. Strategic energy planning under uncertainty. PhD thesis, École Polytechnique Fédérale de Lausanne, 2017. doi:10.5075/EPFL-THESIS-7961.">5</a></sup></span>.
For more details about the research approach, the choice of clustering method or the reconstruction method, see <span id="id2"><sup><a class="reference internal" href="Bibliography.html#id57" title="Gauthier Limpens. Generating energy transition pathways: application to Belgium. PhD thesis, UCLouvain, 2021. doi:10.13140/RG.2.2.25755.18724.">1</a></sup></span>.</p>
</section>
<section id="typical-days-selection">
<span id="sec-td-selection"></span><h2>Typical days selection<a class="headerlink" href="#typical-days-selection" title="Link to this heading"></a></h2>
<p>Resorting to TDs has the main advantage of reducing the computational
time by several orders of magnitude. Usually, studies use between 6 and
20 TDs
<span id="id3"><sup><a class="reference internal" href="Bibliography.html#id50" title="Paolo Gabrielli, Matteo Gazzani, Emanuele Martelli, and Marco Mazzotti. Corrigendum to “Optimal design of multi-energy systems with seasonal storage” [Appl. Energy (2017)]. Applied Energy, 212(June):720, 2018. doi:10.1016/j.apenergy.2017.12.070.">26</a>,<a class="reference internal" href="Bibliography.html#id51" title="Jacques Després, Silvana Mima, Alban Kitous, Patrick Criqui, Nouredine Hadjsaid, and Isabelle Noirot. Storage as a flexibility option in power systems with high shares of variable renewable energy sources: a POLES-based analysis. Energy Economics, 64:638–650, 2017. doi:10.1016/j.eneco.2016.03.006.">27</a>,<a class="reference internal" href="Bibliography.html#id52" title="Paul Nahmmacher, Eva Schmid, Lion Hirth, and Brigitte Knopf. Carpe diem: a novel approach to select representative days for long-term power system modeling. Energy, 112:430–442, 2016.">28</a>,<a class="reference internal" href="Bibliography.html#id53" title="André Pina, Carlos A. Silva, and Paulo Ferrão. High-resolution modeling framework for planning electricity systems with high penetration of renewables. Applied Energy, 112:215–223, 2013. doi:10.1016/j.apenergy.2013.05.074.">29</a></sup></span> and sometimes even less
<span id="id4"><sup><a class="reference internal" href="Bibliography.html#id54" title="Kris Poncelet, Hanspeter Hoschle, Erik Delarue, Ana Virag, and William Drhaeseleer. Selecting representative days for capturing the implications of integrating intermittent renewables in generation expansion planning problems. IEEE Transactions on Power Systems, 32(3):1936–1948, 2017. doi:10.1109/TPWRS.2016.2596803.">30</a>,<a class="reference internal" href="Bibliography.html#id55" title="Fernando Domínguez-Muñoz, José M. Cejudo-López, Antonio Carrillo-Andrés, and Manuel Gallardo-Salazar. Selection of typical demand days for CHP optimization. Energy and Buildings, 43(11):3036–3043, 2011. doi:10.1016/j.enbuild.2011.07.024.">31</a></sup></span>.</p>
<section id="clustering-methods">
<h3>Clustering methods<a class="headerlink" href="#clustering-methods" title="Link to this heading"></a></h3>
<p>In a previous work <span id="id5"><sup><a class="reference internal" href="Bibliography.html#id58" title="Gauthier Limpens, Stefano Moret, Hervé Jeanmart, and Francois Maréchal. EnergyScope TD: A novel open-source model for regional energy systems. Applied Energy, 255(March):113729, 2019.">2</a></sup></span>, it has been estimated
that 12 typical days were appropriate for this model.
Moreover, a comparison between different clustering algorithms showed that the method of
<span id="id6"><sup><a class="reference internal" href="Bibliography.html#id55" title="Fernando Domínguez-Muñoz, José M. Cejudo-López, Antonio Carrillo-Andrés, and Manuel Gallardo-Salazar. Selection of typical demand days for CHP optimization. Energy and Buildings, 43(11):3036–3043, 2011. doi:10.1016/j.enbuild.2011.07.024.">31</a></sup></span> had the best performances.</p>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>A small mistake has been corrected on the distance used in the clustering method.
The impact of this mistake on previous work has been assessed and the conclusion is that the impact is negligible.
The error and explanation are detailed in the pdf Erratum_STEP_1.pdf.</p>
</div>
</section>
<section id="implementing-seasonality-with-typical-days">
<h3>Implementing seasonality with typical days<a class="headerlink" href="#implementing-seasonality-with-typical-days" title="Link to this heading"></a></h3>
<p>Using TDs can introduce some limitations. For example,
model based on TDs are traditionally not able to include inter-days or seasonal
storage due to the discontinuity between the selected days. Thus, they
assess only the capacity of production without accounting for storage
capacities. Carbon-neutral energy system will require long term storage
and thus, this limitation had to be overcome. Therefore, we implemented a
method proposed by <span id="id7">Gabrielli <em>et al.</em><sup><a class="reference internal" href="Bibliography.html#id50" title="Paolo Gabrielli, Matteo Gazzani, Emanuele Martelli, and Marco Mazzotti. Corrigendum to “Optimal design of multi-energy systems with seasonal storage” [Appl. Energy (2017)]. Applied Energy, 212(June):720, 2018. doi:10.1016/j.apenergy.2017.12.070.">26</a></sup></span> to rebuild a year by defining it
as a sequence of typical days. This allows to
optimise the storage level of charge over the 8760 hours of the year.
<span id="id8">Gabrielli <em>et al.</em><sup><a class="reference internal" href="Bibliography.html#id50" title="Paolo Gabrielli, Matteo Gazzani, Emanuele Martelli, and Marco Mazzotti. Corrigendum to “Optimal design of multi-energy systems with seasonal storage” [Appl. Energy (2017)]. Applied Energy, 212(June):720, 2018. doi:10.1016/j.apenergy.2017.12.070.">26</a></sup></span> assigned a TD to each day of the
year; all decision variables are optimised over the TDs, apart from the
amount of energy stored, which is optimised over 8760 hours. This methodology
is illustrated in <a class="reference internal" href="#fig-seasonalityimplementation"><span class="std std-numref">Figure 5</span></a>.</p>
<figure class="align-default" id="fig-seasonalityimplementation">
<a class="reference internal image-reference" href="../_images/gabrielli.png"><img alt="Illustration of the typical days reconstruction method" src="../_images/gabrielli.png" style="width: 14cm;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 5 </span><span class="caption-text">Illustration of the typical days reconstruction method proposed by
<span id="id9"><sup><a class="reference internal" href="Bibliography.html#id50" title="Paolo Gabrielli, Matteo Gazzani, Emanuele Martelli, and Marco Mazzotti. Corrigendum to “Optimal design of multi-energy systems with seasonal storage” [Appl. Energy (2017)]. Applied Energy, 212(June):720, 2018. doi:10.1016/j.apenergy.2017.12.070.">26</a></sup></span> over a week. The example is based
on 3 TDs: TD 1 represents a cloudy weekday, applied to Monday,
Thursday and Friday; TD 2 is a sunny weekday, applied to Tuesday and
Wednesday; finally, TD 3 represents sunny weekend days. The power profile
(above) depends solely on the typical day but the energy stored
(below) is optimised over the 8760 hours of the year (blue curve).
Note that the level of charge is not the same at the beginning
(Monday 1 a.m.) and at the end of the week (Sunday 12 p.m.).</span><a class="headerlink" href="#fig-seasonalityimplementation" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>The performances of this method have been quantified in a previous work <span id="id10"><sup><a class="reference internal" href="Bibliography.html#id58" title="Gauthier Limpens, Stefano Moret, Hervé Jeanmart, and Francois Maréchal. EnergyScope TD: A novel open-source model for regional energy systems. Applied Energy, 255(March):113729, 2019.">2</a></sup></span>.
With 12 typical days, the key performance indicators (cost, emissions, installed capacity and primary energy used) are well captured.
The only exception are the long term storage capacities, which are slightly underestimated (by a factor of 2 at most).</p>
</section>
</section>
<section id="energy-system-model">
<span id="sec-estd"></span><h2>Energy system model<a class="headerlink" href="#energy-system-model" title="Link to this heading"></a></h2>
<p>In this section, we present the core of the energy model. First, we introduce
the conceptual modelling framework with an illustrative example. This helps to
clarify the nomenclature as well. Second, we introduce the
constraints of the optimization problem. The data used in the model, on the other hand, are detailed in the sections <a class="reference internal" href="Input%20Data%20-%20Colombia.html"><span class="doc">Input Data - Colombia</span></a> and <a class="reference internal" href="Input%20Data%20-%20Turkey.html"><span class="doc">Input Data - Turkey</span></a>.</p>
<section id="linear-programming-formulation">
<span id="ssec-lp-framework"></span><h3>Linear programming formulation<a class="headerlink" href="#linear-programming-formulation" title="Link to this heading"></a></h3>
<p>The model is mathematically formulated as a LP problem
<span id="id11"><sup><a class="reference internal" href="Bibliography.html#id59" title="Robert Fourer, David M Gay, and Brian W Kernighan. Ampl: a mathematical programming language. Management Science, 36(5):519–554, 1990.">32</a></sup></span>.
<a class="reference internal" href="#fig-linear-programming-example"><span class="std std-numref">Figure 6</span></a> represents - in a simple
manner - what is a LP problem and the related nomenclature. In italic
capital letters, <em>SETS</em> are collections of distinct items. For example, the <em>RESOURCES</em> set regroups all the
available resources (NG, WOOD, etc.). In italic lowercase letters,
<em>parameters</em> are known values (inputs) of the model, such as specific end-use demands
and resource availabilities. In bold with first letter in uppercase,
<strong>Variables</strong> are unknown values of the model, such as the installed
capacity of PV. These values are determined (i.e. optimised) by the solver
within an upper and a lower bound (both being parameters). For example, the installed capacity of wind turbines is a <em>decision variable</em>. This quantity is bounded between zero and the maximum available wind potential. <em>Decision variables</em> can be split in two categories:
independent decision variables, which can be freely fixed, and dependent
decision variables, which are linked via equality constraints to the
previous ones. For example, the investment cost for wind turbines is a
variable but it directly depends on the installed capacity of wind turbines, which
is an independent decision variable. <em>Constraints</em> are inequality or
equality that must be satisfied between variables parameters. The problem is subject to (<em>s.t.</em>) constraints that can enforce, for example, an energy balance or an upper limit for the availability of resources. Finally, an <em>objective function</em> is a particular variable whose value is to be minimised (or maximised).</p>
<figure class="align-default" id="fig-linear-programming-example">
<a class="reference internal image-reference" href="../_images/chp_estd_lp_conceptual.png"><img alt="Conceptual illustration of a LP problem." src="../_images/chp_estd_lp_conceptual.png" style="width: 14cm;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 6 </span><span class="caption-text">Conceptual illustration of a LP problem, with the related nomenclature.
Description of symbols: maximum installable capacity for a technology
(f <sub>max</sub>), installed capacity of a technology (<strong>F</strong>) and total
system cost (<strong>C_tot</strong>). In this example, a specific technology (<strong>F</strong>
[<em>’PV’</em>]) has been chosen from the set TECHNOLOGY.</span><a class="headerlink" href="#fig-linear-programming-example" title="Link to this image"></a></p>
</figcaption>
</figure>
</section>
<section id="conceptual-modelling-framework">
<span id="app-sec-conceptual-modelling-framework"></span><h3>Conceptual modelling framework<a class="headerlink" href="#conceptual-modelling-framework" title="Link to this heading"></a></h3>
<p>The proposed modelling framework is a simplified representation of an
energy system, accounting for the energy flows within its boundaries. Its
primary objective is to satisfy the energy balance constraints, meaning
that the demand is given and the supply has to meet it. In energy
modelling practice, the energy demand is often expressed in terms of Final Energy Consumption
(FEC). According to the definition of the European commission, FEC is
defined as “<em>the energy which reaches the final consumer’s door</em>”
<span id="id12"><sup><a class="reference internal" href="Bibliography.html#id60" title="European Commission - Eurostat. Glossary: Final Energy Consumption.">33</a></sup></span>. In other words, the FEC is the amount of
input energy needed to satisfy the end-use demand (EUD). For
example, in the case of decentralised heat production with a natural gas boiler,
the FEC is the amount of natural gas consumed by the boiler, while the EUD is the
amount of heat produced by the boiler i.e. the heat delivered to the user.</p>
<p>The input of the proposed modelling framework here is not the FEC but the EUD, related to five energy sectors: electricity,
heating, cooling, mobility and non-energy. This replaces the classical
economic-sector based representation of energy demand. Heat is divided
in three end-use types (EUT): high temperature heat for industry, low temperature heat for
space heating and low temperature heat for hot water. Cooling is divided in two EUTs: process
cooling (for industry) and space cooling. Mobility is divided in
two EUTs: passenger mobility and freight <a class="footnote-reference brackets" href="#id47" id="id13" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a>. Non-energy demand is,
based on the IEA definition, “<em>fuels that are used as raw materials in
the different sectors and are not consumed as a fuel or transformed into
another fuel.</em>” <span id="id14"><sup><a class="reference internal" href="Bibliography.html#id61" title="International Energy Agency. Definitions. URL: https://www.iea.org/statistics/resources/balancedefinitions/ (visited on 29-07-2019).">34</a></sup></span>. For example,
the European Commission classifies as non-energy the following materials:
“<em>chemical feed-stocks, lubricants and asphalt for road construction.</em>”
<span id="id15"><sup><a class="reference internal" href="Bibliography.html#id62" title="Pantelis Capros, A De Vita, N Tasios, P Siskos, M Kannavou, A Petropoulos, S Evangelopoulou, M Zampara, D Papadopoulos, Ch Nakos, and others. Eu reference scenario 2016-energy, transport and ghg emissions trends to 2050. European Commission Directorate-General for Energy, 2016. doi:10.2833/9127.">35</a></sup></span>.</p>
<figure class="align-default" id="fig-conceptual-example">
<a class="reference internal image-reference" href="../_images/chp_estd_conceptual_framework.png"><img alt="Conceptual example of an energy system." src="../_images/chp_estd_conceptual_framework.png" style="width: 16cm;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 7 </span><span class="caption-text">Conceptual example of an energy system with 3 resources, 3 EUDs and 8 technologies,
among which 2 of storage type (coloured oval) and 1 of infrastructure type (grey rectangle).
Abbreviations: pumped hydro storage (PHS), electrical heat pump (eHP), cogenerations of heat and power (CHP), natural gas (NG). Some icons
from <span id="id16"><sup><a class="reference internal" href="Bibliography.html#id63" title="FlatIcon. URL: https://www.flaticon.com (visited on 2019-09-20).">36</a></sup></span>.</span><a class="headerlink" href="#fig-conceptual-example" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>A simplified conceptual example of the energy system’s structure is
proposed in  <a class="reference internal" href="#fig-conceptual-example"><span class="std std-numref">Figure 7</span></a>. The system is
split in three parts: resources, energy conversion and demand. In this
illustrative example, resources are solar energy, electricity and natural gas (NG).
The EUDs are demands for electricity, space heating and passenger mobility. The
energy system encompasses all the energy conversion technologies needed
to transform resources in order to fulfill the EUD. In this example, solar and NG
resources cannot be directly used to supply heat. Thus, technologies are used,
such as boilers or cogenerations of heat and power (CHP) using NG, to supply the EUT layers
(in this case, the <em>high-temperature heat for industry</em> layer). <em>Layers</em> are defined
as all the elements in the system that need to be balanced in each time
period; they include resources and EUTs. For example, the electricity
layer must be balanced at any time, meaning that the production and
storage must equal the consumption and losses. These layers are
connected to one another by <em>technologies</em>. We define three types of
technologies: <em>technologies of end-use type</em>, <em>storage technologies</em> and
<em>infrastructure technologies</em>. A technology of end-use type can convert
the energy (e.g. a fuel resource) from one layer to an EUT layer, such
as a CHP unit that converts NG into heat and electricity. A storage
technology converts energy from a layer to the same one, such as thermal storage (TS) that
stores heat to provide heat. In our example (<a class="reference internal" href="#fig-conceptual-example"><span class="std std-numref">Figure 7</span></a>), there are two storage technologies:
TS for heat and pumped hydro storage (PHS) for electricity. Infrastructure technologies
include all the remaining technologies, including the networks, such as the
power grid and district heating networks (DHN), but also technologies linking non end-use layers,
such as methane production from wood gasification or hydrogen production
from methane reforming.</p>
<p>As an illustrative example of the concept of <em>layer</em>, <a class="reference internal" href="#fig-layerelec"><span class="std std-numref">Figure 8</span></a>
presents a sketch of the electricity layer,
which is the most complex one since the electrification of other
sectors is foreseen as a key element of the energy transition
<span id="id17"><sup><a class="reference internal" href="Bibliography.html#id64" title="Masahiro Sugiyama. Climate change mitigation and electrification. Energy Policy, 44:464–468, 2012. doi:10.1016/j.enpol.2012.01.028.">37</a></sup></span>. In the version of EnergyScope described in this document,
54 technologies are related to the electricity layer. 16 technologies
produce electricity exclusively, such as combined cycle gas turbine (CCGT), rooftop PV or onshore wind. 14
cogenerations of heat and power (CHPs) produce both heat and electricity,
such as industrial waste CHP. 10 technologies are related to the
production of synthetic fuels and to carbon capture and storage (CCS). 1 infrastructure technology represents the
electrical grid. 6 storage technologies are implemented, such as PHS, batteries or
vehicle-to-grid (V2G). The rest relates to the electrification of heat
and mobility. Electrification of the heating sector is supported by
direct electric heating and, most importantly, by electrical heat pumps.
Electrification of mobility is achieved via electric public
transportation (train, trolley, metro and electrical/hybrid bus),
electric private transportation including battery and hydrogen cars <a class="footnote-reference brackets" href="#id48" id="id18" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a> and
electric freight with trains.</p>
<figure class="align-default" id="fig-layerelec">
<a class="reference internal image-reference" href="../_images/Layer_Elec.png"><img alt="Representation of the Electricity layer." src="../_images/Layer_Elec.png" style="width: 16cm;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 8 </span><span class="caption-text">Representation of the <em>electricity</em> layer with all the technologies
implemented in ESTD v2.1. (The version descripted in this document is v2.2.)
Bold italic technologies represent a group
of different technologies. Abbreviations: electricity (elec.), industrial (ind.),
combined cycle gas turbine (CCGT), integrated gasification combined cycle with coal (IGCC),
cogeneration of heat and power (CHP), heat pump (HP), pumped hydro storage (PHS),
vehicle-to-grid (V2G), synthetic methanolation (S. Methanol.), atmospheric (atm.),
carbon capture (CC), end-use demand (EUD).</span><a class="headerlink" href="#fig-layerelec" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>The model is formulated as a LP problem. It optimises the design of the energy system
by computing the installed capacity of each technology, as well as the
operation in each period, that minimizes the
total annual cost of the system while meeting the energy demand. In the following sections, we present the
complete formulation of the model in two steps. First, all the terms
used are summarised in a figure and a set of tables (<a class="reference internal" href="#fig-sets"><span class="std std-numref">Figure 9</span></a>
for sets, Tables <a class="reference internal" href="#tab-paramsdistributions"><span class="std std-numref">1</span></a> and
<a class="reference internal" href="#tab-params"><span class="std std-numref">2</span></a> for parameters, Tables
<a class="reference internal" href="#tab-variablesindependent"><span class="std std-numref">3</span></a> and
<a class="reference internal" href="#tab-variablesdependent"><span class="std std-numref">4</span></a> for variables). Second, on
this basis, the equations representing the constraints and the objective
function are presented in <a class="reference internal" href="#fig-endusedemand"><span class="std std-numref">Figure 10</span></a> and detailed in
Eqs. <a class="reference internal" href="#equation-eq-obj-func">(1)</a> - <a class="reference internal" href="#equation-eq-efficiency">(41)</a>.</p>
</section>
<section id="sets-parameters-and-variables">
<span id="ssec-sets-params-vars"></span><h3>Sets, parameters and variables<a class="headerlink" href="#sets-parameters-and-variables" title="Link to this heading"></a></h3>
<p><a class="reference internal" href="#fig-sets"><span class="std std-numref">Figure 9</span></a> gives a visual representation of the sets
used in EnergyScope, together with their respective indices. Tables
<a class="reference internal" href="#tab-paramsdistributions"><span class="std std-numref">1</span></a> and <a class="reference internal" href="#tab-params"><span class="std std-numref">2</span></a>
list and describe the model parameters. Tables
<a class="reference internal" href="#tab-variablesindependent"><span class="std std-numref">3</span></a> and
<a class="reference internal" href="#tab-variablesdependent"><span class="std std-numref">4</span></a> list and describe
the independent and dependent variables, respectively.</p>
<figure class="align-default" id="fig-sets">
<img alt="Visual representation of the sets and indices used." src="../_images/ses_sets_v2.png" />
<figcaption>
<p><span class="caption-number">Fig. 9 </span><span class="caption-text">Visual representation of the sets and indices used in the LP
framework. This figure was produced for ESTD v2.1 and does not
include the latest technologies and EUDs included in v2.2, such
as the ones related to cooling.
Abbreviations: space heating (SH), heating water (HW), temperature (T),
mobility (MOB), passenger (<em>Pass.</em>), vehicle-to-grid (V2G), thermal storage (TS).</span><a class="headerlink" href="#fig-sets" title="Link to this image"></a></p>
</figcaption>
</figure>
<div class="docutils container">
<table class="docutils align-default" id="tab-paramsdistributions">
<caption><span class="caption-number">Table 1 </span><span class="caption-text">Exhaustive list of time series parameters used in ESTD v2.2.</span><a class="headerlink" href="#tab-paramsdistributions" title="Link to this table"></a></caption>
<thead>
<tr class="row-odd"><th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Units</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\%_{elec}(h,td)\)</span></p></td>
<td><p>[-]</p></td>
<td><p>Yearly time series
(adding up to 1) of
electricity EUD</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\%_{sh}(h,td)\)</span></p></td>
<td><p>[-]</p></td>
<td><p>Yearly time series
(adding up to 1) of space
heating EUD</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\%_{sc}(h,td)\)</span></p></td>
<td><p>[-]</p></td>
<td><p>Yearly time series
(adding up to 1) of space
cooling EUD</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\%_{pass}(h,td)\)</span></p></td>
<td><p>[-]</p></td>
<td><p>Yearly time series
(adding up to 1) of
passenger mobility EUD</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\%_{fr}(h,td)\)</span></p></td>
<td><p>[-]</p></td>
<td><p>Yearly time series
(adding up to 1) of
freight mobility EUD</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(c_{p,t}(tech,h,td)\)</span></p></td>
<td><p>[-]</p></td>
<td><p>Hourly maximum capacity
factor for each
technology (default 1)</p></td>
</tr>
</tbody>
</table>
</div>
<div class="docutils container">
<table class="docutils align-default" id="tab-params">
<caption><span class="caption-number">Table 2 </span><span class="caption-text">Exhaustive list of parameters (except time series) used in ESTD v2.2.</span><a class="headerlink" href="#tab-params" title="Link to this table"></a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Units</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\tau\)</span>(tech)</p></td>
<td><p>[-]</p></td>
<td><p>Investment cost
annualization factor</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(i_{rate}\)</span></p></td>
<td><p>[-]</p></td>
<td><p>Real discount rate</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(endUses_
{year} (eui,s)\)</span></p></td>
<td><p>[GWh/y] <a class="reference internal" href="#a" id="id19"><span>[a]</span></a></p></td>
<td><p>Annual EUD values
divided per sector</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(endUsesInput
(eui)\)</span></p></td>
<td><p>[GWh/y] <a class="reference internal" href="#a" id="id20"><span>[a]</span></a></p></td>
<td><p>Total annual EUD
values</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(re_{share}\)</span></p></td>
<td><p>[-]</p></td>
<td><p>Minimum share [0;1]
of primary energy
coming from
renewables</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(gwp
_{limit}\)</span></p></td>
<td><p>[ktCO<span class="math notranslate nohighlight">\(_{2}\)</span>-eq/y]</p></td>
<td><p>Upper
CO<span class="math notranslate nohighlight">\(_{2}\)</span>-eq
emissions limit</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\%_
{public,min},
\%_{public,max}\)</span></p></td>
<td><p>[-]</p></td>
<td><p>Lower and upper
limit to
<span class="math notranslate nohighlight">\(\textbf{%}_
{\textbf{Public}}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\%_
{fr,rail,min},
\%_{fr,rail,max}\)</span></p></td>
<td><p>[-]</p></td>
<td><p>Lower and upper
limit to
<span class="math notranslate nohighlight">\(\textbf{%}_
{\textbf{Fr,Rail}}\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\%_
{fr,boat,min},
\%_{fr,boat,max}\)</span></p></td>
<td><p>[-]</p></td>
<td><p>Lower and upper
limit to
<span class="math notranslate nohighlight">\(\textbf{%}_
{\textbf{Fr,Boat}}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\%_
{fr,truck,min},
\%_{fr,truck,max}\)</span></p></td>
<td><p>[-]</p></td>
<td><p>Lower and upper
limit to
<span class="math notranslate nohighlight">\(\textbf{%}_
{\textbf{Fr,Truck}}\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\%_
{private,motorc,max}\)</span></p></td>
<td><p>[-]</p></td>
<td><p>Max. share of
private mobility
supplied by
motorcycles</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\%_
{dhn,min},
\%_{dhn,max}\)</span></p></td>
<td><p>[-]</p></td>
<td><p>Lower and upper
limit to
<span class="math notranslate nohighlight">\(\textbf{%}_
{\textbf{Dhn}}\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\%_
{ned}(EUT\_OF\_EUC(
NON\_ENERGY))\)</span></p></td>
<td><p>[-]</p></td>
<td><p>Share of non-energy
demand per type
of feedstock</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(t_
{op}(h,td)\)</span></p></td>
<td><p>[h]</p></td>
<td><p>Duration of each
time period (default
1h)</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(f_{min},
f_{max}
(tech)\)</span></p></td>
<td><p>[GW] <a class="reference internal" href="#a" id="id21"><span>[a]</span></a> <a class="reference internal" href="#b" id="id22"><span>[b]</span></a></p></td>
<td><p>Min./max. installed
size of each
technology</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(f_{min,\%},
f_{max,\%}(tech)\)</span></p></td>
<td><p>[-]</p></td>
<td><p>Min./max. relative
share of each
technology in a
layer</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(avail(res)\)</span></p></td>
<td><p>[GWh/y]</p></td>
<td><p>Yearly total
availability of each
resource</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(c_{op}(res)\)</span></p></td>
<td><p>[M€<span class="math notranslate nohighlight">\(_{2015}\)</span>/GWh]</p></td>
<td><p>Specific cost of
resource</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(veh_{capa}\)</span></p></td>
<td><p>[km-pass/h/veh.] <a class="reference internal" href="#a" id="id23"><span>[a]</span></a></p></td>
<td><p>Mobility capacity
per vehicle (veh.)</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\%_{
Peak_{sh}}\)</span></p></td>
<td><p>[-]</p></td>
<td><p>Ratio between highest
yearly demand and
highest demand in TDs
for space heating</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\%_{
Peak_{sc}}\)</span></p></td>
<td><p>[-]</p></td>
<td><p>Ratio between highest
yearly demand and
highest demand in TDs
for space cooling</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(f(
res\cup tech
\setminus sto, l)\)</span></p></td>
<td><p>[GW] <a class="reference internal" href="#c" id="id24"><span>[c]</span></a></p></td>
<td><p>Input from (&lt;0) or
output to (&gt;0) layers
. f(i,j) = 1 if j is
main output layer for
technology/resource
i.</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(c_
{inv}(tech)\)</span></p></td>
<td><p>[M€<span class="math notranslate nohighlight">\(_{2015}\)</span>
/GW] <a class="reference internal" href="#c" id="id25"><span>[c]</span></a> <a class="reference internal" href="#b" id="id26"><span>[b]</span></a></p></td>
<td><p>Technology specific
investment cost</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(c_{maint}
(tech)\)</span></p></td>
<td><p>[M€<span class="math notranslate nohighlight">\(_{2015}\)</span>
/GW/y]
<a class="reference internal" href="#c" id="id27"><span>[c]</span></a> <a class="reference internal" href="#b" id="id28"><span>[b]</span></a></p></td>
<td><p>Technology specific
yearly maintenance
cost</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\({
lifetime}(tech)\)</span></p></td>
<td><p>[y]</p></td>
<td><p>Technology lifetime</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(gwp_{constr}
(tech)\)</span></p></td>
<td><p>[ktCO<span class="math notranslate nohighlight">\(_2\)</span>-eq./GW]
<a class="reference internal" href="#a" id="id29"><span>[a]</span></a> <a class="reference internal" href="#b" id="id30"><span>[b]</span></a></p></td>
<td><p>Technology
construction
specific GHG
emissions</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(gwp_
{op}(res)\)</span></p></td>
<td><p>[ktCO<span class="math notranslate nohighlight">\(_2\)</span>-eq./GWh]</p></td>
<td><p>Specific GHG
emissions of
resources</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(c_{p}(tech)\)</span></p></td>
<td><p>[-]</p></td>
<td><p>Yearly mean capacity
factor</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\eta_{s
to,in},\eta_{sto
,out} (sto,l)\)</span></p></td>
<td><p>[-]</p></td>
<td><p>Efficiency [0;1] of
storage input from/
output to layer. Set
to 0 if storage not
related to layer</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\%_{
sto_{loss}}(sto)\)</span></p></td>
<td><p>[1/h]</p></td>
<td><p>Losses in storage
(self-discharge)</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(t_{sto_{in}}
(sto)\)</span></p></td>
<td><p>[-]</p></td>
<td><p>Time to fully charge
storage (energy to
power ratio)</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(t_{sto_{out}}
(sto)\)</span></p></td>
<td><p>[-]</p></td>
<td><p>Time to fully
discharge storage
(energy to power
ratio)</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\%_
{sto_{avail}}
(sto)\)</span></p></td>
<td><p>[-]</p></td>
<td><p>Storage technology
availability for
charge/discharge</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\%_{net_
{loss}}(eut)\)</span></p></td>
<td><p>[-]</p></td>
<td><p>Losses coefficient
<span class="math notranslate nohighlight">\([0;1]\)</span> in the
networks (grid and
DHN)</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(ev_{b
att,size}(v2g)\)</span></p></td>
<td><p>[GWh]</p></td>
<td><p>Battery size of each
V2G car technology</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(soc_{min,ev}
(v2g,h)\)</span></p></td>
<td><p>[GWh]</p></td>
<td><p>Minimum state of
charge for electric
vehicles</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\%_{max,
motorcycle}\)</span></p></td>
<td><p>[GWh]</p></td>
<td><p>Maximum share of
motorcycles in
private mobility</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(c_
{grid,extra}\)</span></p></td>
<td><p>[M€<span class="math notranslate nohighlight">\(_{2015}\)</span>/GW]</p></td>
<td><p>Cost to reinforce
the grid per GW of
installed
intermittent
renewable</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(elec_{
import,max}\)</span></p></td>
<td><p>[GW]</p></td>
<td><p>Maximum import
capacity for
electricity</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(elec_{
export,max}\)</span></p></td>
<td><p>[GW]</p></td>
<td><p>Maximum export
capacity for
electricity</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(solar_{
area,rooftop}\)</span></p></td>
<td><p>[km<span class="math notranslate nohighlight">\(^2\)</span>]</p></td>
<td><p>Available area for
solar technologies
on rooftops</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(solar_{
area,ground}\)</span></p></td>
<td><p>[km<span class="math notranslate nohighlight">\(^2\)</span>]</p></td>
<td><p>Available land area
for solar
technologies on the
ground</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(solar_{
area,ground,high irr
}\)</span></p></td>
<td><p>[km<span class="math notranslate nohighlight">\(^2\)</span>]</p></td>
<td><p>Available land area
with high irradiation
for solar
technologies on the
ground</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(sm_{max}\)</span></p></td>
<td><p>[-]</p></td>
<td><p>Maximum solar
multiple for CSP
plants</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(powerDensity
_{pv}\)</span></p></td>
<td><p>[GW/km<span class="math notranslate nohighlight">\(^2\)</span>]</p></td>
<td><p>Maximum power
irradiance for PV</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(powerDensity
_{solar,thermal}\)</span></p></td>
<td><p>[GW/km<span class="math notranslate nohighlight">\(^2\)</span>]</p></td>
<td><p>Maximum power
irradiance for solar
thermal</p></td>
</tr>
</tbody>
</table>
</div>
<div role="list" class="citation-list">
<div class="citation" id="a" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>a<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id19">1</a>,<a role="doc-backlink" href="#id20">2</a>,<a role="doc-backlink" href="#id21">3</a>,<a role="doc-backlink" href="#id23">4</a>,<a role="doc-backlink" href="#id29">5</a>)</span>
<p>Generally [GWh/y], but [Mpkm] (millions of passenger-km) for passenger mobility EUD
and [Mtkm] (millions of ton-km) for freight mobility EUD</p>
</div>
<div class="citation" id="b" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>b<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id22">1</a>,<a role="doc-backlink" href="#id26">2</a>,<a role="doc-backlink" href="#id28">3</a>,<a role="doc-backlink" href="#id30">4</a>)</span>
<p>GWh instead of GW if <span class="math notranslate nohighlight">\({{tech}} \in {{STO}}\)</span></p>
</div>
<div class="citation" id="c" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>c<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id24">1</a>,<a role="doc-backlink" href="#id25">2</a>,<a role="doc-backlink" href="#id27">3</a>)</span>
<p>[Mpkm/h] for passenger mobility EUD, [Mtkm/h] for freight mobility EUD</p>
</div>
</div>
<div class="docutils container">
<table class="docutils align-default" id="tab-variablesindependent">
<caption><span class="caption-number">Table 3 </span><span class="caption-text">Exhaustive list of independent variables used in ESTD v2.2. All variables are continuous and non-negative, unless otherwise indicated.</span><a class="headerlink" href="#tab-variablesindependent" title="Link to this table"></a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Variable</p></th>
<th class="head"><p>Units</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\textbf{%}_{
\textbf{Public}}\)</span></p></td>
<td><p>[-]</p></td>
<td><p>Ratio <span class="math notranslate nohighlight">\([0;1]\)</span>
public mobility over
total passenger mobility</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\textbf{%}_{
\textbf{Fr,Rail}}\)</span></p></td>
<td><p>[-]</p></td>
<td><p>Ratio <span class="math notranslate nohighlight">\([0;1]\)</span> rail
transport over total
freight transport</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\textbf{%}_{
\textbf{Fr,Boat}}\)</span></p></td>
<td><p>[-]</p></td>
<td><p>Ratio <span class="math notranslate nohighlight">\([0;1]\)</span> boat
transport over total
freight transport</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\textbf{%}_{
\textbf{Fr,Truck}}\)</span></p></td>
<td><p>[-]</p></td>
<td><p>Ratio <span class="math notranslate nohighlight">\([0;1]\)</span> truck
transport over total
freight transport</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\textbf{%}_{
\textbf{Dhn}}\)</span></p></td>
<td><p>[-]</p></td>
<td><p>Ratio <span class="math notranslate nohighlight">\([0;1]\)</span>
centralized over total
low-temperature heating</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\textbf{F}(tech)\)</span></p></td>
<td><p>[GW] <a class="reference internal" href="#d" id="id31"><span>[d]</span></a></p></td>
<td><p>Installed capacity with
respect to main output</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\textbf{F}_
{\textbf{t}}(tech
\cup res,h,td)\)</span></p></td>
<td><p>[GW] <a class="reference internal" href="#d" id="id32"><span>[d]</span></a></p></td>
<td><p>Operation in each period</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\textbf{Sto}_{
\textbf{in}},
\textbf{Sto}_{
\textbf{out}}
(sto, l, h, td)\)</span></p></td>
<td><p>[GW]</p></td>
<td><p>Input to/output from
storage units</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\textbf{P}_{
\textbf{Nuclear}}\)</span></p></td>
<td><p>[GW]</p></td>
<td><p>Constant load of nuclear</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\textbf{%}_{
\textbf{PassMob}}(TECH\
OF\ EUC(PassMob))\)</span></p></td>
<td><p>[-]</p></td>
<td><p>Constant share of
passenger mobility</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\textbf{%}_{
\textbf{FreightMob}}
(TECH~OF~EUC(FreightMob))\)</span></p></td>
<td><p>[-]</p></td>
<td><p>Constant share of
freight mobility</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\textbf{%}_{
\textbf{HeatLowTDEC}}
(TECH~OF~EUT(HeatLowTDec)
\setminus {Dec_{Solar}}
)\)</span></p></td>
<td><p>[-]</p></td>
<td><p>Constant share of low
temperature heat
decentralised supplied
by a technology plus its
associated thermal solar
and storage</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\textbf{F}_{
\textbf{sol}}
(TECH~OF~EUT(HeatLowTDec)
\setminus {Dec_{Solar}})\)</span></p></td>
<td><p>[-]</p></td>
<td><p>Solar thermal installed
capacity associated to a
decentralised heating
technology</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\textbf{F}_{
\textbf{t}_{\textbf{sol}}}
(TECH~OF~EUT(HeatLowTDec)
\setminus {Dec_{Solar}})\)</span></p></td>
<td><p>[-]</p></td>
<td><p>Solar thermal operation
in each period</p></td>
</tr>
</tbody>
</table>
</div>
<div role="list" class="citation-list">
<div class="citation" id="d" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>d<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id31">1</a>,<a role="doc-backlink" href="#id32">2</a>)</span>
<p>[Mpkm] (millions of passenger-km) for passenger mobility EUD,
[Mtkm] (millions of ton-km) for freight EUD</p>
</div>
</div>
<div class="docutils container">
<table class="docutils align-default" id="tab-variablesdependent">
<caption><span class="caption-number">Table 4 </span><span class="caption-text">Exhaustive list of dependent variables used in ESTD v2.2. All variables are continuous and non-negative, unless otherwise indicated.</span><a class="headerlink" href="#tab-variablesdependent" title="Link to this table"></a></caption>
<thead>
<tr class="row-odd"><th class="head"><p><strong>Variable</strong></p></th>
<th class="head"><p><strong>Units</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\textbf{
EndUses}(l,h,td)\)</span></p></td>
<td><p>[GW] <a class="reference internal" href="#e" id="id33"><span>[e]</span></a></p></td>
<td><p>EUD. Set
to 0 if
<span class="math notranslate nohighlight">\(l \notin\)</span>
<em>EUT</em></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\textbf{C}_
{\textbf{tot}}\)</span></p></td>
<td><p>[M€<sub>2015</sub>/y]</p></td>
<td><p>Total annual cost of
the energy system</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\textbf{C}_
{\textbf{inv}}(
tech)\)</span></p></td>
<td><p>[M€<sub>2015</sub>]</p></td>
<td><p>Total
investment cost
of technology</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\textbf{C}_
{\textbf{maint}}(
tech)\)</span></p></td>
<td><p>[M€<sub>2015</sub>/y]</p></td>
<td><p>Yearly maintenance
cost of technology</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\textbf{C}_
{\textbf{op}}(
res)\)</span></p></td>
<td><p>[M€<sub>2015</sub>/y]</p></td>
<td><p>Total cost of
resource</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\textbf{GWP}_
{\textbf{tot}}\)</span></p></td>
<td><p>[ktCO<span class="math notranslate nohighlight">\(_2\)</span>-eq./y]</p></td>
<td><p>Total yearly GHG
emissions of the
energy system</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\textbf{GWP}_
{\textbf{constr}}(
tech)\)</span></p></td>
<td><p>[ktCO<span class="math notranslate nohighlight">\(_2\)</span>-eq.]</p></td>
<td><p>GHG emissions during
construction of
technology</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\textbf{GWP}_
{\textbf{po}}(
res)\)</span></p></td>
<td><p>[ktCO<span class="math notranslate nohighlight">\(_2\)</span>-eq./y]</p></td>
<td><p>Total GHG emissions
of resource</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\textbf{Net}_
{\textbf{losses}}(
eut,h,td)\)</span></p></td>
<td><p>[GW]</p></td>
<td><p>Losses in the
networks (grid and
DHN)</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\textbf{Sto}_
{\textbf{level}}(
sto,t)\)</span></p></td>
<td><p>[GWh]</p></td>
<td><p>Energy stored over
the year</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\textbf{
ImportConstant}(
RES~IMPORT~CONSTANT)\)</span></p></td>
<td><p>[GWh]</p></td>
<td><p>Constant value of
import over the year</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\textbf{
Export}_{\textbf{
constant}}
(EXPORT~E~FUEL)\)</span></p></td>
<td><p>[GWh]</p></td>
<td><p>Constant value of
export of each
e-fuel over the year</p></td>
</tr>
</tbody>
</table>
</div>
<div role="list" class="citation-list">
<div class="citation" id="e" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id33">e</a><span class="fn-bracket">]</span></span>
<p>[Mpkm] (millions of passenger-km) for passenger mobility EUD,
[Mtkm] (millions of ton-km) for freight EUD</p>
</div>
</div>
</section>
<section id="energy-model-formulation">
<span id="ssec-lp-formulation"></span><h3>Energy model formulation<a class="headerlink" href="#energy-model-formulation" title="Link to this heading"></a></h3>
<p>In the following, sub-sections, the overall LP formulation is proposed through <a class="reference internal" href="#fig-endusedemand"><span class="std std-numref">Figure 10</span></a> and equations
 <a class="reference internal" href="#equation-eq-obj-func">(1)</a> - <a class="reference internal" href="#equation-eq-solararealandlimited">(52)</a>.
The first constraints presented relate to the computation of the EUDs.
Then, the cost, the global warming potential (GWP) and the objective
functions are introduced. The sub-sections coming after are more specific,
describing for example the implementations of <em>storage</em> or <em>vehicle-to-grid</em>.</p>
<section id="end-use-demand">
<h4>End-use demand<a class="headerlink" href="#end-use-demand" title="Link to this heading"></a></h4>
<p>Giving as input to the model the EUD instead of the FEC has two advantages. First, it
introduces a clear distinction between demand and supply. On the one
hand, the demand concerns end-uses (e.g. mobility needs). On the other
hand, the supply concerns the choice of the energy conversion
technologies to supply these services (e.g. the types of vehicles used
to satisfy the mobility needs). Based on technology choice, the same
EUD can be satisfied with different FECs. Second, using the EUD facilitates the
inclusion in the model of electric technologies for heating and
transportation.</p>
<figure class="align-default" id="fig-endusedemand">
<a class="reference internal image-reference" href="../_images/EndUseDemand.png"><img alt="Hourly **EndUses** demands calculation." src="../_images/EndUseDemand.png" style="width: 16cm;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 10 </span><span class="caption-text">Hourly <strong>EndUses</strong> demands calculation, starting from yearly demand
inputs (<em>endUsesInput</em>). Adapted from
<span id="id34"><sup><a class="reference internal" href="Bibliography.html#id56" title="Stefano Moret. Strategic energy planning under uncertainty. PhD thesis, École Polytechnique Fédérale de Lausanne, 2017. doi:10.5075/EPFL-THESIS-7961.">5</a></sup></span>.
This figure was produced for ESTD v2.1. It does not
show the latest EUDs related to cooling and included in v2.2.
Abbreviations: space heating
(sh), district heating network (DHN), high value chemicals (HVC), hot water (HW), passenger
(pass), freight (fr) and non-energy demand (NED).</span><a class="headerlink" href="#fig-endusedemand" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>The hourly EUDs (<strong>EndUses</strong>) are computed based on the
yearly EUDs (<em>endUsesInput</em>), distributed according to the
time series listed in <a class="reference internal" href="#tab-paramsdistributions"><span class="std std-numref">Table 1</span></a>.
<a class="reference internal" href="#fig-endusedemand"><span class="std std-numref">Figure 10</span></a> graphically presents the constraints
associated to the hourly EUDs (<strong>EndUses</strong>). For example, the public
mobility demand at time <span class="math notranslate nohighlight">\(t\)</span> is equal to the hourly passenger
mobility demand multiplied by the public mobility share (<span class="math notranslate nohighlight">\(\textbf{%}_{\textbf{Public}}\)</span>).</p>
<p>Electricity EUD results from the sum of the electricity-only demand,
assumed constant throughout the year, and the variable demand for
electricity, distributed across the periods according to <span class="math notranslate nohighlight">\(\%_{elec}\)</span>.
Low-temperature heat demand results from the sum of the demand
for hot water (HW), evenly shared across the year, and the demand
for space heating (SH), distributed across the
periods according to <span class="math notranslate nohighlight">\(\%_{sh}\)</span>. The percentage repartition between
centralized (DHN) and decentralized heat demand is defined by the
variable <span class="math notranslate nohighlight">\(\textbf{%}_{\textbf{Dhn}}\)</span>. High temperature heat
for industrial processes is evenly distributed across the periods. Passenger mobility demand is
expressed in passenger-kilometers (pkms), while freight demand
is in ton-kilometers (tkms). The variable <span class="math notranslate nohighlight">\(\textbf{%}_{\textbf{Public}}\)</span> defines the
penetration of public transportation in passenger mobility.
Similarly, <span class="math notranslate nohighlight">\(\textbf{%}_{\textbf{Rail}}\)</span>, <span class="math notranslate nohighlight">\(\textbf{%}_{\textbf{Boat}}\)</span> and <span class="math notranslate nohighlight">\(\textbf{%}_{\textbf{Truck}}\)</span> define the
penetration of train, boat and trucks for freight mobility, respectively.</p>
<p>Space cooling demands were added in ESTD v2.2 and are not represented on <a class="reference internal" href="#fig-endusedemand"><span class="std std-numref">Figure 10</span></a>.
The demand for space cooling (SC) is distributed across the periods according to <span class="math notranslate nohighlight">\(\%_{sc}\)</span>,
while the cooling demand for industrial processes is uniform.</p>
</section>
<section id="cost-emissions-and-objective-function">
<h4>Cost, emissions and objective function<a class="headerlink" href="#cost-emissions-and-objective-function" title="Link to this heading"></a></h4>
<div class="math notranslate nohighlight" id="equation-eq-obj-func">
<span class="eqno">(1)<a class="headerlink" href="#equation-eq-obj-func" title="Link to this equation"></a></span>\[\text{min } \textbf{C}_{\textbf{tot}} = \sum_{j \in \text{TECH}} \Big(\textbf{$\tau$}(j) \textbf{C}_{\textbf{inv}}(j) + \textbf{C}_{\textbf{maint}} (j)\Big) + \sum_{i \in \text{RES}} \textbf{C}_{\textbf{op}}(i)\]</div>
<div class="math notranslate nohighlight" id="equation-eq-tau">
<span class="eqno">(2)<a class="headerlink" href="#equation-eq-tau" title="Link to this equation"></a></span>\[\begin{split}\text{s.t. }  \textbf{$\tau$}(j) =  \frac{i_{\text{rate}}(i_{\text{rate}}+1)^{lifetime(j)}}{(i_{\text{rate}}+1)^{lifetime(j)} - 1} ~~~~~~ \forall j \in \text{TECH}\\\end{split}\]</div>
<div class="math notranslate nohighlight" id="equation-eq-c-inv">
<span class="eqno">(3)<a class="headerlink" href="#equation-eq-c-inv" title="Link to this equation"></a></span>\[\begin{split}\textbf{C}_{\textbf{inv}}(j) = c_{\text{inv}}(j) \textbf{F}(j) ~~~~~~ \forall j \in \text{TECH}\\\end{split}\]</div>
<div class="math notranslate nohighlight" id="equation-eq-c-maint">
<span class="eqno">(4)<a class="headerlink" href="#equation-eq-c-maint" title="Link to this equation"></a></span>\[\begin{split}\textbf{C}_{\textbf{maint}}(j) = c_{\text{maint}}(j) \textbf{F}(j) ~~~~~~ \forall j \in \text{TECH}\\\end{split}\]</div>
<div class="math notranslate nohighlight" id="equation-eq-c-op">
<span class="eqno">(5)<a class="headerlink" href="#equation-eq-c-op" title="Link to this equation"></a></span>\[\textbf{C}_{\textbf{op}}(i) = \sum_{t \in T | \{h,td\} \in T\_H\_TD(t)} c_{\text{op}}(i) \textbf{F}_{\textbf{t}}(i,h,td) t_{op} (h,td)
~~~~~~ \forall i \in \text{RES}\]</div>
<p>The objective function to minimize is given in Eq. <a class="reference internal" href="#equation-eq-obj-func">(1)</a>. It is the
the total annual cost of the energy system (<span class="math notranslate nohighlight">\(\textbf{C}_{\textbf{tot}}\)</span>),
defined as the sum of the annualized investment cost of the technologies
(<span class="math notranslate nohighlight">\(\tau\textbf{C}_{\textbf{inv}}\)</span>), the operating and maintenance costs of the
technologies (<span class="math notranslate nohighlight">\(\textbf{C}_{\textbf{maint}}\)</span>) and the operating cost of the resources
(<span class="math notranslate nohighlight">\(\textbf{C}_{\textbf{op}}\)</span>). The total investment cost (<span class="math notranslate nohighlight">\(\textbf{C}_{\textbf{inv}}\)</span>) of each technology
results from the multiplication of its specific investment cost
(<span class="math notranslate nohighlight">\(c_{inv}\)</span>) by its installed capacity (<strong>F</strong>) (Eq. <a class="reference internal" href="#equation-eq-c-inv">(3)</a>), the latter being defined with
respect to the main end-use output type <a class="footnote-reference brackets" href="#id49" id="id35" role="doc-noteref"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></a>. <span class="math notranslate nohighlight">\(\textbf{C}_{\textbf{inv}}\)</span> is annualised using the
factor <span class="math notranslate nohighlight">\(\tau\)</span>, calculated based on the interest rate (<span class="math notranslate nohighlight">\(t_{op}\)</span>)
and the technology lifetime (<em>lifetime</em>) in Eq. <a class="reference internal" href="#equation-eq-tau">(2)</a>.
The total operation and maintenance cost is calculated in the same way in
Eq. <a class="reference internal" href="#equation-eq-c-maint">(4)</a>. In Eq. <a class="reference internal" href="#equation-eq-c-op">(5)</a>, the total cost of the resources is
calculated as the sum of the end-use over different periods multiplied
by the periods’ duration (<span class="math notranslate nohighlight">\(t_{op}\)</span>) and the specific cost of the resource
(<span class="math notranslate nohighlight">\(c_{op}\)</span>). Note that in Eq. <a class="reference internal" href="#equation-eq-c-op">(5)</a>, summing over the typical days using the
set T_H_TD <a class="footnote-reference brackets" href="#id50" id="id36" role="doc-noteref"><span class="fn-bracket">[</span>4<span class="fn-bracket">]</span></a> is equivalent to summing over the 8760h of the year.</p>
<div class="math notranslate nohighlight" id="equation-eq-gwp-tot">
<span class="eqno">(6)<a class="headerlink" href="#equation-eq-gwp-tot" title="Link to this equation"></a></span>\[ \begin{align}\begin{aligned}\textbf{GWP}_\textbf{tot}  = \sum_{j \in \text{TECH}} \frac{\textbf{GWP}_\textbf{constr} (j)}{lifetime(j)} +   \sum_{i \in \text{RES}} \textbf{GWP}_\textbf{op} (i)\\\left(\text{in this version of the model} :   \textbf{GWP}_\textbf{tot}  =    \sum_{i \in \text{RES}} \textbf{GWP}_\textbf{op} (i) \right)\end{aligned}\end{align} \]</div>
<div class="math notranslate nohighlight" id="equation-eq-gwp-constr">
<span class="eqno">(7)<a class="headerlink" href="#equation-eq-gwp-constr" title="Link to this equation"></a></span>\[\textbf{GWP}_\textbf{constr}(j) = gwp_{\text{constr}}(j) \textbf{F}(j) ~~~~~~ \forall j \in \text{TECH}\]</div>
<div class="math notranslate nohighlight" id="equation-eq-gwp-op">
<span class="eqno">(8)<a class="headerlink" href="#equation-eq-gwp-op" title="Link to this equation"></a></span>\[\textbf{GWP}_\textbf{op}(i) = \sum_{t \in T| \{h,td\} \in T\_H\_TD(t)} gwp_\text{op}(i) \textbf{F}_\textbf{t}(i,h,td)  t_{op} (h,td )~~~~~~ \forall i \in \text{RES}\]</div>
<p>The global annual GHG emissions are calculated using a life-cycle assessment (LCA) approach,
i.e. taking into account emissions of the technologies and resources
‘<em>from cradle to grave</em>’. For climate change, the natural choice as
indicator is the global warming potential (GWP), expressed in ktCO<span class="math notranslate nohighlight">\(_2\)</span>-eq./year. In
Eq. <a class="reference internal" href="#equation-eq-gwp-tot">(6)</a>, the total yearly emissions of the
system (<span class="math notranslate nohighlight">\(\textbf{GWP}_{\textbf{tot}}\)</span>) are defined as the sum of the emissions related to
the construction and end-of-life of the energy conversion technologies
(<span class="math notranslate nohighlight">\(\textbf{GWP}_{\textbf{constr}}\)</span>), annualized based on the technology
lifetime (<span class="math notranslate nohighlight">\(lifetime\)</span>), and the emissions related to resources
(<span class="math notranslate nohighlight">\(\textbf{GWP}_{\textbf{op}}\)</span>). Similarly to the costs, the total emissions related to
the construction of technologies are computed in Eq. <a class="reference internal" href="#equation-eq-gwp-constr">(7)</a> as the product of the specific
emissions (<span class="math notranslate nohighlight">\(gwp_{constr}\)</span>) by the installed capacity (<span class="math notranslate nohighlight">\(\textbf{F}\)</span>). In Eq. <a class="reference internal" href="#equation-eq-gwp-op">(8)</a>,
the total emissions of the resources are computed as the emissions associated to fuels from cradle to
combustion and imports of electricity (<span class="math notranslate nohighlight">\(gwp_{op}\)</span>), multiplied by the
period duration (<span class="math notranslate nohighlight">\(t_{op}\)</span>). GWP
accounting can be conducted in different manners depending on the choice of scope. The
European Commission and the IEA mainly use resource-related emissions
(<span class="math notranslate nohighlight">\(\textbf{GWP}_{\textbf{op}}\)</span>) while neglecting indirect emissions related to the
construction of technologies (<span class="math notranslate nohighlight">\(\textbf{GWP}_{\textbf{constr}}\)</span>). To facilitate the
comparison with their results, a similar implementation is proposed in
Eq. <a class="reference internal" href="#equation-eq-gwp-tot">(6)</a>.</p>
</section>
<section id="system-design-and-operation">
<span id="app-sec-system-design-and-operation"></span><h4>System design and operation<a class="headerlink" href="#system-design-and-operation" title="Link to this heading"></a></h4>
<div class="math notranslate nohighlight" id="equation-eq-fmin-fmax">
<span class="eqno">(9)<a class="headerlink" href="#equation-eq-fmin-fmax" title="Link to this equation"></a></span>\[f_{\text{min}} (j) \leq \textbf{F}(j) \leq f_{\text{max}} (j) ~~~~~~ \forall j \in \text{TECH}\]</div>
<p>Eq. <a class="reference internal" href="#equation-eq-fmin-fmax">(9)</a> imposes that the installed capacity of a technology (<strong>F</strong>) is constrained by
upper and lower bounds (<span class="math notranslate nohighlight">\(f_{max}\)</span> and <span class="math notranslate nohighlight">\(f_{min}\)</span>). This formulation allows for
accounting for old technologies still existing in the target year (lower
bound), but also for the maximum deployment potential of a technology.
For example, regarding offshore wind turbines, (<span class="math notranslate nohighlight">\(f_{min}\)</span>) represents
the existing installed capacity (which will still be available in the near
future), while (<span class="math notranslate nohighlight">\(f_{max}\)</span>) represents the maximum potential.</p>
<div class="math notranslate nohighlight" id="equation-eq-cp-t">
<span class="eqno">(10)<a class="headerlink" href="#equation-eq-cp-t" title="Link to this equation"></a></span>\[\textbf{F}_\textbf{t}(i,h,td) \leq \textbf{F}_\textbf{t}(i) \cdot c_{p,t} (i,h,td) ~~~~~~ \forall i \in \text{TECH}, h \in H, td \in TD\]</div>
<div class="math notranslate nohighlight" id="equation-eq-c-p">
<span class="eqno">(11)<a class="headerlink" href="#equation-eq-c-p" title="Link to this equation"></a></span>\[ \begin{align}\begin{aligned}\sum_{t \in T| \{h,td\} \in T\_H\_TD(t)} \textbf{F}_\textbf{t}(j,h,td) t_{op}(h,td)  \leq   \textbf{F} (j) c_{p} (j) \sum_{t \in T| \{h,td\} \in T\_H\_TD(t)} t_{op} (h,td)\\\forall j \in \text{TECH}\end{aligned}\end{align} \]</div>
<div class="math notranslate nohighlight" id="equation-eq-res-avail">
<span class="eqno">(12)<a class="headerlink" href="#equation-eq-res-avail" title="Link to this equation"></a></span>\[\sum_{t \in T| \{h,td\} \in T\_H\_TD(t)} \textbf{F}_\textbf{t}(i,h,td) t_{op}(h,td)  \leq \text{avail} (i) ~~~~~~ \forall i \in \text{RES}\]</div>
<p>The operation of resources and technologies in each period is determined
by the decision variable <span class="math notranslate nohighlight">\(\textbf{F}_{\textbf{t}}\)</span>. The capacity factor of technologies
is conceptually divided into two components: a capacity factor for each
period (<span class="math notranslate nohighlight">\(c_{p,t}\)</span>) depending on resource availability (e.g. renewables)
and a yearly capacity factor (<span class="math notranslate nohighlight">\(c_{p}\)</span>) accounting for technology downtime
and maintenance. For a given technology, the definition of only one of
these two is needed, the other one being fixed to the default value of
1. For example, intermittent renewables are constrained by an hourly
load factor (<span class="math notranslate nohighlight">\(c_{p,t}\in[0;1]\)</span>) while CCGTs are constrained by
an annual load factor (<span class="math notranslate nohighlight">\(c_{p}\)</span>) (with a value in that case of 96% in 2035).
Eqs. <a class="reference internal" href="#equation-eq-cp-t">(10)</a> and <a class="reference internal" href="#equation-eq-c-p">(11)</a> link the
installed size of a technology to its actual use in each period (<span class="math notranslate nohighlight">\(\textbf{F}_{\textbf{t}}\)</span>)
via the two capacity factors. The total use of resources is limited by
the yearly availability (<span class="math notranslate nohighlight">\(avail\)</span>) in Eq. <a class="reference internal" href="#equation-eq-res-avail">(12)</a>.</p>
<div class="math notranslate nohighlight" id="equation-eq-layer-balance">
<span class="eqno">(13)<a class="headerlink" href="#equation-eq-layer-balance" title="Link to this equation"></a></span>\[ \begin{align}\begin{aligned}\sum_{i \in \text{RES}~\cup \text{TECH} \setminus \text{STO}} f(i,l) \textbf{F}_\textbf{t}(i,h,td) + \sum_{j \in \text{STO}} \bigg(\textbf{Sto}_\textbf{out}(j,l,h,td) - \textbf{Sto}_\textbf{in}(j,l,h,td)\bigg)\\- \textbf{EndUses}(l,h,td) = 0\\\forall l \in L, \forall h \in H, \forall td \in TD\end{aligned}\end{align} \]</div>
<p>The matrix <span class="math notranslate nohighlight">\(f\)</span> defines, for all technologies and resources,
their output layers (positive) and input layers (negative).
Eq. <a class="reference internal" href="#equation-eq-layer-balance">(13)</a> expresses the balance
for each layer: all outputs from resources and technologies (including
storage) are used to satisfy the EUDs or as inputs to other resources and
technologies.</p>
</section>
<section id="storage">
<h4>Storage<a class="headerlink" href="#storage" title="Link to this heading"></a></h4>
<div class="math notranslate nohighlight" id="equation-eq-sto-level">
<span class="eqno">(14)<a class="headerlink" href="#equation-eq-sto-level" title="Link to this equation"></a></span>\[ \begin{align}\begin{aligned}\textbf{Sto}_\textbf{level} (j,t) =    \textbf{Sto}_\textbf{level} (j,t-1)\cdot\left(1 - \%_{sto_{loss}}(j) \right)\\ + t_{op} (h,td)\cdot \Big(\sum_{l \in L | \eta_{\text{sto,in} (j,l) &gt; 0}} \textbf{Sto}_\textbf{in}  (j,l,h,td) \eta_{\text{sto,in}} (j,l)\\ ~~~~~~ - \sum_{l \in L | \eta_{\text{sto,out} (j,l) &gt; 0}} \textbf{Sto}_\textbf{out} (j,l,h,td) /  \eta_{\text{sto,out}} (j,l)\Big)\\ \forall j \in \text{STO}, \forall t \in \text{T}| \{h,td\} \in T\_H\_TD(t)\end{aligned}\end{align} \]</div>
<div class="math notranslate nohighlight" id="equation-eq-sto-level-bound-daily">
<span class="eqno">(15)<a class="headerlink" href="#equation-eq-sto-level-bound-daily" title="Link to this equation"></a></span>\[\textbf{Sto}_\textbf{level} (j,t) = \textbf{F}_\textbf{t} (j,h,td) ~~~~~~ \forall j \in \text{STO DAILY},\forall t \in \text{T}| \{h,td\} \in T\_H\_TD(t)\]</div>
<div class="math notranslate nohighlight" id="equation-eq-sto-level-bound">
<span class="eqno">(16)<a class="headerlink" href="#equation-eq-sto-level-bound" title="Link to this equation"></a></span>\[\textbf{Sto}_\textbf{level} (j,t) \leq \textbf{F} (j) ~~~~~~ \forall j \in \text{STO} \setminus \text{STO DAILY},\forall t \in \text{T}\]</div>
<p>In Eq. <a class="reference internal" href="#equation-eq-sto-level">(14)</a>, the storage level
(<span class="math notranslate nohighlight">\(\textbf{Sto}_{\textbf{level}}\)</span>) at time step <span class="math notranslate nohighlight">\(t\)</span> is defined as
the storage level at <span class="math notranslate nohighlight">\(t-1\)</span> (accounting for the losses in
<span class="math notranslate nohighlight">\(t-1\)</span>), plus the inputs to the storage, minus the output from the
storage (accounting for input/output efficiencies). The storage systems which can
only be used for short-term (daily) applications are included in the
daily storage set (STO DAILY). For these units,
Eq. <a class="reference internal" href="#equation-eq-sto-level-bound-daily">(15)</a>: imposes
that the storage level be the same at the end of each typical day <a class="footnote-reference brackets" href="#id51" id="id37" role="doc-noteref"><span class="fn-bracket">[</span>5<span class="fn-bracket">]</span></a>.
Adding this constraint drastically reduces the computational time. For
the other storage technologies, which can also be used for seasonal
storage, the capacity is bounded by
Eq. <a class="reference internal" href="#equation-eq-sto-level-bound">(16)</a>. For these units,
the storage behaviour is thus optimized over 8760 hours.</p>
<div class="math notranslate nohighlight" id="equation-eq-stoinceil">
<span class="eqno">(17)<a class="headerlink" href="#equation-eq-stoinceil" title="Link to this equation"></a></span>\[\textbf{Sto}_\textbf{in}(j,l,h,td)\cdot \Big(\lceil  \eta_{sto,in}(j,l)\rceil -1 \Big) = 0  ~~~~~~ \forall j \in \text{STO},\forall l \in \text{L}, \forall h \in \text{H}, \forall td \in \text{TD}\]</div>
<div class="math notranslate nohighlight" id="equation-eq-stooutceil">
<span class="eqno">(18)<a class="headerlink" href="#equation-eq-stooutceil" title="Link to this equation"></a></span>\[\textbf{Sto}_\textbf{out}(j,l,h,td)\cdot \Big(\lceil  \eta_{sto,out}(j,l)\rceil -1 \Big) = 0  ~~~~~~ \forall j \in \text{STO},\forall l \in \text{L}, \forall h \in \text{H}, \forall td \in \text{TD}\]</div>
<div class="math notranslate nohighlight" id="equation-eq-limitchargeanddischarge">
<span class="eqno">(19)<a class="headerlink" href="#equation-eq-limitchargeanddischarge" title="Link to this equation"></a></span>\[ \begin{align}\begin{aligned}\Big(\textbf{Sto}_\textbf{in} (j,l,h,td)t_{sto_{in}}(\text{j}) + \textbf{Sto}_\textbf{out}(j,l,h,td)t_{sto_{out}}(\text{j})\Big) \leq \textbf{F} (j)\%_{sto_{avail}}(j)\\\forall j \in STO \setminus {V2G} , \forall l \in L, \forall h \in H, \forall td \in TD\end{aligned}\end{align} \]</div>
<p>Eqs. <a class="reference internal" href="#equation-eq-stoinceil">(17)</a> - <a class="reference internal" href="#equation-eq-stooutceil">(18)</a>
force the power input and output to zero if the layer is
incompatible <a class="footnote-reference brackets" href="#id52" id="id38" role="doc-noteref"><span class="fn-bracket">[</span>6<span class="fn-bracket">]</span></a>. For example, a PHS will only be linked to the
electricity layer (input/output efficiencies <span class="math notranslate nohighlight">\(&gt;\)</span> 0). All other
efficiencies will be equal to 0, to impede that the PHS exchanges with
incompatible layers (e.g. mobility, heat, etc).
Eq. <a class="reference internal" href="#equation-eq-limitchargeanddischarge">(19)</a>
limits the power input/output of a storage technology based on its
installed capacity (<strong>F</strong>) and three specific characteristics. First,
storage availability (<span class="math notranslate nohighlight">\(\%_{sto_{avail}}\)</span>) is defined as the ratio between
the available storage capacity and the total installed capacity (default
value is 100%). This parameter is only used to realistically represent
V2G, for which we assume that only a fraction of the fleet (i.e. 20% in
these cases) can charge/discharge at the same time. Second and third,
the charging/discharging time (<span class="math notranslate nohighlight">\(t_{sto_{in}}\)</span>, <span class="math notranslate nohighlight">\(t_{sto_{out}}\)</span>), which are
the time to complete a full charge/discharge from empty/full
storage <a class="footnote-reference brackets" href="#id53" id="id39" role="doc-noteref"><span class="fn-bracket">[</span>7<span class="fn-bracket">]</span></a>. For example, a daily thermal storage needs at least 4
hours to discharge
(<span class="math notranslate nohighlight">\(t_{sto_{out}}=4\)</span>[h]), and
another 4 hours to charge
(<span class="math notranslate nohighlight">\(t_{sto_{in}}=4\)</span>[h]). Eq. <a class="reference internal" href="#equation-eq-limitchargeanddischarge">(19)</a> applies for
all storage except electric vehicles which are limited by another constraint Eq. <a class="reference internal" href="#equation-eq-limitchargeanddischarge-ev">(32)</a>, presented later.</p>
</section>
<section id="networks">
<h4>Networks<a class="headerlink" href="#networks" title="Link to this heading"></a></h4>
<div class="math notranslate nohighlight" id="equation-eq-loss">
<span class="eqno">(20)<a class="headerlink" href="#equation-eq-loss" title="Link to this equation"></a></span>\[ \begin{align}\begin{aligned}\textbf{Net}_\textbf{loss}(eut,h,td) = \Big(\sum_{i \in \text{RES} \cup \text{TECH} \setminus \text{STO} | f(i,eut) &gt; 0} f(i,eut)\textbf{F}_\textbf{t}(i,h,td) \Big) \%_{\text{net}_{loss}} (eut)\\\forall eut = \text{EUT}, \forall h \in H, \forall td \in TD\end{aligned}\end{align} \]</div>
<div class="math notranslate nohighlight" id="equation-eq-mult-grid">
<span class="eqno">(21)<a class="headerlink" href="#equation-eq-mult-grid" title="Link to this equation"></a></span>\[ \begin{align}\begin{aligned}\textbf{F} (Grid) = 1 + \frac{c_{grid,extra}}{c_{inv}(Grid)}
\Big(
\textbf{F}(Wind_{onshore}) + \textbf{F}(Wind_{offshore}) + \textbf{F}(PV)\\-\big(
f_{min}(Wind_{onshore}) + f_{min}(Wind_{offshore}) + f_{min}(PV)
\big)
\Big)\end{aligned}\end{align} \]</div>
<div class="math notranslate nohighlight" id="equation-eq-dhncost">
<span class="eqno">(22)<a class="headerlink" href="#equation-eq-dhncost" title="Link to this equation"></a></span>\[\textbf{F} (DHN) = \sum_{j \in \text{TECH} \setminus {STO} | f(j,\text{HeatLowTDHN}) &gt;0} f(j,\text{HeatLowTDHN}) \cdot \textbf{F} (j)\]</div>
<p>Eq. <a class="reference internal" href="#equation-eq-loss">(20)</a> calculates network losses as a share
(<span class="math notranslate nohighlight">\(\%_{\text{net}_{loss}}\)</span>) of the total energy transferred through the network. As
an example, losses in the electricity grid are estimated to be 4.5% of
the energy transferred in 2015 <a class="footnote-reference brackets" href="#id54" id="id40" role="doc-noteref"><span class="fn-bracket">[</span>8<span class="fn-bracket">]</span></a>.
Eqs. <a class="reference internal" href="#equation-eq-mult-grid">(21)</a> - <a class="reference internal" href="#equation-eq-dhncost">(22)</a>
define the extra investment for networks. Integration of intermittent RE
implies additional investment costs for the electricity grid
(<span class="math notranslate nohighlight">\(c_{grid,ewtra}\)</span>). For example, the reinforcement of the electricity
grid is estimated to be 358 millions €<sub>2015</sub> per Gigawatt of
intermittent renewable capacity installed (see
<a class="reference external" href="#ssec:app1_grid:">Data for the grid</a> for details).
Eq. <a class="reference internal" href="#equation-eq-dhncost">(22)</a> links the size of DHN to the total
size of the installed centralized energy conversion technologies.</p>
</section>
<section id="additional-constraints">
<h4>Additional Constraints<a class="headerlink" href="#additional-constraints" title="Link to this heading"></a></h4>
<div class="math notranslate nohighlight" id="equation-eq-cstnuke">
<span class="eqno">(23)<a class="headerlink" href="#equation-eq-cstnuke" title="Link to this equation"></a></span>\[\textbf{F}_\textbf{t} (Nuclear,h,td) = \textbf{P}_\textbf{Nuclear}  ~~~~~~ \forall h \in H, \forall td \in TD\]</div>
<p>Nuclear power plants are assumed to have no power variation over the
year, Eq. <a class="reference internal" href="#equation-eq-cstnuke">(23)</a>. If needed, this equation can
be replicated for all other technologies for which a constant operation
over the year is desired.</p>
<div class="math notranslate nohighlight" id="equation-eq-mob-share-fix">
<span class="eqno">(24)<a class="headerlink" href="#equation-eq-mob-share-fix" title="Link to this equation"></a></span>\[ \begin{align}\begin{aligned}\textbf{F}_\textbf{t} (j,h,td) = \textbf{%}_\textbf{PassMob} (j)   \sum_{l \in EUT\_of\_EUC(PassMob)} \textbf{EndUses}(l,h,td)\\\forall j \in TECH\_OF\_EUC(PassMob) , \forall h \in H, \forall td \in TD\end{aligned}\end{align} \]</div>
<div class="math notranslate nohighlight" id="equation-eq-freight-share-fix">
<span class="eqno">(25)<a class="headerlink" href="#equation-eq-freight-share-fix" title="Link to this equation"></a></span>\[ \begin{align}\begin{aligned}\textbf{F}_\textbf{t} (j,h,td) = \textbf{%}_\textbf{FreightMob} (j)   \sum_{l \in EUT\_of\_EUC(FreightMob)} \textbf{EndUses}(l,h,td)\\\forall j \in TECH\_OF\_EUC(FreightMob) , \forall h \in H, \forall td \in TD\end{aligned}\end{align} \]</div>
<div class="math notranslate nohighlight" id="equation-eq-freight-share-constant">
<span class="eqno">(26)<a class="headerlink" href="#equation-eq-freight-share-constant" title="Link to this equation"></a></span>\[\textbf{%}_\textbf{Fr,Rail} + \textbf{%}_\textbf{Fr,Train} + \textbf{%}_\textbf{Fr,Boat} = 1\]</div>
<p>Eqs. <a class="reference internal" href="#equation-eq-mob-share-fix">(24)</a> - <a class="reference internal" href="#equation-eq-freight-share-fix">(25)</a>
impose that the share of the different technologies for mobility
(<span class="math notranslate nohighlight">\(\textbf{%}_{\textbf{PassMob}}\)</span>) and (<span class="math notranslate nohighlight">\(\textbf{%}_{\textbf{Freight}}\)</span>) be the same at each time
step <a class="footnote-reference brackets" href="#id56" id="id41" role="doc-noteref"><span class="fn-bracket">[</span>9<span class="fn-bracket">]</span></a>. In other words, if 20% of the mobility is supplied by train,
this share remains constant in the morning or the afternoon.
Eq. <a class="reference internal" href="#equation-eq-freight-share-constant">(26)</a>
verifies that the freight technologies supply the overall freight demand
(this constraint is related to <a class="reference internal" href="#fig-endusedemand"><span class="std std-numref">Figure 10</span></a>).</p>
</section>
<section id="decentralised-heat-production">
<h4>Decentralised heat production<a class="headerlink" href="#decentralised-heat-production" title="Link to this heading"></a></h4>
<div class="math notranslate nohighlight" id="equation-eq-de-strategy-dec-total-st">
<span class="eqno">(27)<a class="headerlink" href="#equation-eq-de-strategy-dec-total-st" title="Link to this equation"></a></span>\[\textbf{F} (Dec_{Solar}) = \sum_{j \in \text{TECH OF EUT} (\text{HeatLowTDec}) \setminus \{ Dec_{Solar} \}} \textbf{F}_\textbf{sol} (j)\]</div>
<div class="math notranslate nohighlight" id="equation-eq-op-strategy-dec-total-st">
<span class="eqno">(28)<a class="headerlink" href="#equation-eq-op-strategy-dec-total-st" title="Link to this equation"></a></span>\[ \begin{align}\begin{aligned}\textbf{F}_{\textbf{t}_\textbf{sol}} (j,h,td) \leq  \textbf{F}_\textbf{sol} (j)  c_{p,t}(Dec_{Solar},h,td)\\\forall j \in \text{TECH OF EUT} (\text{HeatLowTDec}) \setminus \{ Dec_{Solar} \}, \forall h\in H, \forall td \in TD\end{aligned}\end{align} \]</div>
<p>Thermal solar is implemented as a decentralized technology. It is always
installed together with another decentralized technology, which serves
as backup to compensate for the intermittency of solar thermal. Thus, we
define the total installed capacity of solar thermal
<strong>F</strong>(<span class="math notranslate nohighlight">\(Dec_{solar}\)</span>) as the sum of <span class="math notranslate nohighlight">\(\textbf{F}_{\textbf{sol}}(j)\)</span>,
Eq. <a class="reference internal" href="#equation-eq-de-strategy-dec-total-st">(27)</a>,
where <span class="math notranslate nohighlight">\(\textbf{F}_{\textbf{sol}}(j)\)</span> is the solar thermal
capacity associated to the backup technology <span class="math notranslate nohighlight">\(j\)</span>.
Eq. <a class="reference internal" href="#equation-eq-op-strategy-dec-total-st">(28)</a>
links the installed size of each solar thermal capacity
<span class="math notranslate nohighlight">\(\textbf{F}_{\textbf{sol}}(j)\)</span> to its actual production
:<span class="math notranslate nohighlight">\(\textbf{F}_{\textbf{t}_\textbf{sol}}(j,h,td)\)</span> via the
solar capacity factor (<span class="math notranslate nohighlight">\(c_{solar_{area,rooftop}p,t}(Dec_{solar})\)</span>).</p>
<div class="math notranslate nohighlight" id="equation-eq-heat-decen-share">
<span class="eqno">(29)<a class="headerlink" href="#equation-eq-heat-decen-share" title="Link to this equation"></a></span>\[ \begin{align}\begin{aligned}\textbf{F}_\textbf{t} (j,h,td) + \textbf{F}_{\textbf{t}_\textbf{sol}} (j,h,td)\\+ \sum_{l \in \text{L}}\Big( \textbf{Sto}_\textbf{out} (i,l,h,td) - \textbf{Sto}_\textbf{in} (i,l,h,td) \Big)\\= \textbf{%}_\textbf{HeatDec}(\text{j}) \textbf{EndUses}(HeatLowT,h,td)\\\forall j \in \text{TECH OF EUT} (\text{HeatLowTDec}) \setminus \{ Dec_{Solar} \},\\i \in \text{TS OF DEC TECH}(j)  , \forall h\in H, \forall td \in TD\end{aligned}\end{align} \]</div>
<figure class="align-default" id="fig-fsolandtsimplementation">
<a class="reference internal image-reference" href="../_images/ts_and_Fsolv2.png"><img alt="Illustrative example of a decentralised heating layer." src="../_images/ts_and_Fsolv2.png" style="width: 12cm;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 11 </span><span class="caption-text">Illustrative example of a decentralised heating layer with thermal
storage, solar thermal and two conventional production technologies,
gas boilers and electrical HP. In this case,
Eq. <a class="reference internal" href="#equation-eq-heat-decen-share">(29)</a> applied to the
electrical HPs becomes the equality between the two following terms:
left term is the heat produced by: the eHPs
(<span class="math notranslate nohighlight">\(\textbf{F}_{\textbf{t}}(eHPs,h,td)\)</span>), the solar panel
associated to the eHPs
(<span class="math notranslate nohighlight">\(\textbf{F}_{\textbf{t}_\textbf{sol}}(eHPs,h,td)\)</span>) and
the storage associated to the eHPs; right term is the product between
the share of decentralised heat supplied by eHPs
(<span class="math notranslate nohighlight">\(\textbf{%}_{\textbf{HeatDec}}(eHPs)\)</span>) and heat low temperature decentralised
demand (<span class="math notranslate nohighlight">\(\textbf{EndUses}(HeatLowT,h,td)\)</span>).</span><a class="headerlink" href="#fig-fsolandtsimplementation" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>A thermal storage <span class="math notranslate nohighlight">\(i\)</span> is defined for each decentralised heating
technology <span class="math notranslate nohighlight">\(j\)</span>, to which it is related via the set <em>TS OF DEC TECH</em>,
i.e. <span class="math notranslate nohighlight">\(i\)</span>=<em>TS OF DEC TECH(j)</em>. Each thermal storage <span class="math notranslate nohighlight">\(i\)</span> can store
heat from its technology <span class="math notranslate nohighlight">\(j\)</span> and the associated thermal solar
<span class="math notranslate nohighlight">\(\textbf{F}_{\textbf{sol}}\)</span> (<span class="math notranslate nohighlight">\(j\)</span>). Similarly to the passenger mobility,
Eq. <a class="reference internal" href="#equation-eq-heat-decen-share">(29)</a> makes the model
more realistic by defining the operating strategy for decentralized
heating. In fact, in the model we represent decentralized heat in an
aggregated form; however, in a real case, residential heat cannot be
aggregated. A house heated by a decentralised gas boiler and solar
thermal panels should not be able to be heated by the electrical heat
pump and thermal storage of the neighbours, and vice-versa. Hence,
Eq. <a class="reference internal" href="#equation-eq-heat-decen-share">(29)</a> imposes that the
use of each technology (<span class="math notranslate nohighlight">\(\textbf{F}_{\textbf{t}}(j,h,td)\)</span>),
plus its associated thermal solar
(<span class="math notranslate nohighlight">\(\textbf{F}_{\textbf{t}_\textbf{sol}}(j,h,td)\)</span>) plus
its associated storage outputs
(<span class="math notranslate nohighlight">\(\textbf{Sto}_{\textbf{out}}(i,l,h,td)\)</span>) minus its associated
storage inputs (<span class="math notranslate nohighlight">\(\textbf{Sto}_{\textbf{in}}(i,l,h,td)\)</span>) should
be a constant share (<span class="math notranslate nohighlight">\(\textbf{%}_{\textbf{HeatDec}}(j)\)</span>) of the decentralised heat
demand <span class="math notranslate nohighlight">\((\textbf{EndUses}(HeatLowT,h,td)\)</span>). <a class="reference internal" href="#fig-fsolandtsimplementation"><span class="std std-numref">Figure 11</span></a> shows, through an example with
two technologies (a gas boiler and a HP), how decentralised thermal
storage and thermal solar are implemented.</p>
</section>
<section id="vehicle-to-grid">
<h4>Vehicle-to-grid<a class="headerlink" href="#vehicle-to-grid" title="Link to this heading"></a></h4>
<figure class="align-default" id="fig-v2gandbatteries">
<a class="reference internal image-reference" href="../_images/v2gAndBatteries.png"><img alt="Illustrative example of a V2G implementation." src="../_images/v2gAndBatteries.png" style="width: 7cm;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 12 </span><span class="caption-text">Illustrative example of a V2G implementation. The battery can
interact with the electricity layer.
The size of the battery is directly related to the number of cars (see Eq. <a class="reference internal" href="#equation-eq-sizeofbev">(30)</a>).
The V2G takes the electricity from the battery to provide a constant share (<span class="math notranslate nohighlight">\(\textbf{%}_{\textbf{PassMob}}\)</span>) of the
passenger mobility layer (<em>Mob. Pass.</em>). Thus, it imposes the amount of electricity that electric car must deserve (see Eq. <a class="reference internal" href="#equation-eq-btobev">(31)</a>).
The remaining capacity of battery available can be used to provide V2G services (see <a class="reference internal" href="#equation-eq-limitchargeanddischarge-ev">(32)</a>).</span><a class="headerlink" href="#fig-v2gandbatteries" title="Link to this image"></a></p>
</figcaption>
</figure>
<div class="math notranslate nohighlight" id="equation-eq-sizeofbev">
<span class="eqno">(30)<a class="headerlink" href="#equation-eq-sizeofbev" title="Link to this equation"></a></span>\[\textbf{F} (i) = \frac{\textbf{F} (j)}{ veh_{capa} (j)} ev_{batt,size} (j)  ~~~~~~ \forall  j \in  V2G, i \in \text{EVs_BATT OF V2G}(j)\]</div>
<p>Vehicle-to-grid dynamics are included in the model via the <em>V2G</em> set.
For each vehicle <span class="math notranslate nohighlight">\(j \in V2G\)</span>, a battery <span class="math notranslate nohighlight">\(i\)</span> (<span class="math notranslate nohighlight">\(i\)</span>
<span class="math notranslate nohighlight">\(\in\)</span> <em>EVs_BATT</em>) is associated using the set EVs_BATT_OF_V2G
(<span class="math notranslate nohighlight">\(i \in \text{EVs_BATT_OF_V2G}(j)\)</span>). Each type <span class="math notranslate nohighlight">\(j\)</span>
of <em>V2G</em> has a different size of battery per car
(<span class="math notranslate nohighlight">\(ev_{batt,size}(j)\)</span>), e.g. the first generation battery of the
Nissan Leaf (ZE0) has a capacity of 24 kWh <a class="footnote-reference brackets" href="#id57" id="id42" role="doc-noteref"><span class="fn-bracket">[</span>10<span class="fn-bracket">]</span></a>. The number of vehicles
of a given technology is calculated with the installed capacity (<strong>F</strong>)
in [km-pass/h] and its capacity per vehicles (<span class="math notranslate nohighlight">\(veh_{capa}\)</span> in
[km-pass/h/veh.]). Thus, the energy that can be stored in batteries
<strong>F</strong>(<span class="math notranslate nohighlight">\(i\)</span>) of <em>V2G</em>(<span class="math notranslate nohighlight">\(j\)</span>) is the ratio of the installed capacity of
vehicle by its specific capacity per vehicles times the size of battery
per car (<span class="math notranslate nohighlight">\(ev_{batt,size}(j)\)</span>), Eq.
<a class="reference internal" href="#equation-eq-sizeofbev">(30)</a>. For example, if this technology
of cars covers 10 Mpass-km/h, and the capacity per vehicle is 50.4
pass-km/car/h (which represents an average speed of 40km/h and occupancy
of 1.26 passenger per car); thus, the amount of BEV cars are 0.198
million cars. And if a BEV has a 24kWh of battery, such as the Nissan
Leaf (ZE0), thus, the equivalent battery has a capacity of 4.76 GWh.</p>
<div class="math notranslate nohighlight" id="equation-eq-btobev">
<span class="eqno">(31)<a class="headerlink" href="#equation-eq-btobev" title="Link to this equation"></a></span>\[ \begin{align}\begin{aligned}\textbf{Sto}_\textbf{out} (j,Elec,h,td) \geq - f(i,Elec) \textbf{F}_\textbf{t} (i,h,td)\\\forall i \in V2G , \forall j \in \text{EVs_BATT OF V2G}(j), \forall h \in H, td \in TD\end{aligned}\end{align} \]</div>
<p>Eq. <a class="reference internal" href="#equation-eq-btobev">(31)</a> forces batteries of electric vehicles
to supply, at least, the energy required by each associated electric
vehicle technology. This lower bound is not an equality; in fact,
according to the V2G concept, batteries can also be used to support the
grid. <a class="reference internal" href="#fig-v2gandbatteries"><span class="std std-numref">Figure 12</span></a> shows through an example
with only BEVs how Eq. <a class="reference internal" href="#equation-eq-btobev">(31)</a> simplifies the
implementation of V2G. In this illustration, a battery technology is
associated to a BEV. The battery can either supply the BEV needs or
sends electricity back to the grid.</p>
<div class="math notranslate nohighlight" id="equation-eq-limitchargeanddischarge-ev">
<span class="eqno">(32)<a class="headerlink" href="#equation-eq-limitchargeanddischarge-ev" title="Link to this equation"></a></span>\[ \begin{align}\begin{aligned}\textbf{Sto}_\textbf{in} (j,l,h,td)t_{sto_{in}}(\text{j}) + \Big(\textbf{Sto}_\textbf{out}(j,l,h,td) + f(i,Elec) \textbf{F}_\textbf{t} (i,h,td) \Big) \cdot t_{sto_{out}}(\text{j})\\\leq \Big( \textbf{F} (j) - \frac{\textbf{F} (j)}{ veh_{capa} (j)} ev_{batt,size} (j) \Big) \cdot \%_{sto_{avail}}(j)\\\forall i \in V2G , \forall j \in \text{EVs_BATT OF V2G}(j) , \forall l \in L, \forall h \in H, \forall td \in TD\end{aligned}\end{align} \]</div>
<p>Eq. <a class="reference internal" href="#equation-eq-limitchargeanddischarge-ev">(32)</a> limits the availability of batteries to the number of vehicle connected to the grid.
This equation is similar to the one for other type of storage (see Eq. <a class="reference internal" href="#equation-eq-limitchargeanddischarge">(19)</a>);
except that a part of the batteries are not accounted, i.e. the one running (see Eq. <a class="reference internal" href="#equation-eq-btobev">(31)</a>).
Therefore, the available output is corrected by removing the electricity powering the running car (here, <span class="math notranslate nohighlight">\(f(i,Elec) \leq 0\)</span>)
and the available batteries is corrected by removing the numbers of electric cars running (<span class="math notranslate nohighlight">\(\frac{\textbf{F} (j)}{ veh_{capa} (j)} ev_{batt,size} (j)\)</span>).</p>
<div class="math notranslate nohighlight" id="equation-eq-ev-min-state-of-charge">
<span class="eqno">(33)<a class="headerlink" href="#equation-eq-ev-min-state-of-charge" title="Link to this equation"></a></span>\[ \begin{align}\begin{aligned}\textbf{Sto}_\textbf{level} (j,t) \geq \textbf{F}[i] soc_{ev}(i,h)\\\forall i \in V2G , \forall j \in \text{EVs_BATT OF V2G}(j) , \forall t \in T| \{h,td\} \in T\_H\_TD\end{aligned}\end{align} \]</div>
<p>For each electric vehicle (<span class="math notranslate nohighlight">\(ev\)</span>), a minimum state of charge is imposed for each hour of the day big(<span class="math notranslate nohighlight">\(soc_{ev}(i,h)\)</span>big).
For example, we can impose that the state of charge of EV is 60% in the morning, to ensure that cars can be used to go for work.
Eq. <a class="reference internal" href="#equation-eq-ev-min-state-of-charge">(33)</a> imposes, for each type of <cite>V2G</cite>,
that the level of charge of the EV batteries is greater than the minimum state of charge times the storage capacity.</p>
</section>
<section id="peak-demand">
<h4>Peak demand<a class="headerlink" href="#peak-demand" title="Link to this heading"></a></h4>
<div class="math notranslate nohighlight" id="equation-eq-dec-peak">
<span class="eqno">(34)<a class="headerlink" href="#equation-eq-dec-peak" title="Link to this equation"></a></span>\[ \begin{align}\begin{aligned}\textbf{F} (j)
\geq
\%_{Peak_{sh}}\max_{h\in H,td\in TD}\left\{\textbf{F}_\textbf{t}(j,h,td)\right\}\\\forall j \in \text{TECH OF  EUT} (HeatLowTDEC)   \setminus \{ Dec_{Solar}\}\end{aligned}\end{align} \]</div>
<div class="math notranslate nohighlight" id="equation-eq-dhn-peak">
<span class="eqno">(35)<a class="headerlink" href="#equation-eq-dhn-peak" title="Link to this equation"></a></span>\[ \begin{align}\begin{aligned}\sum_{\hspace{3cm}j \in \text{TECH OF EUT} (HeatLowTDHN), i \in \text{STO OF EUT}(HeatLowTDHN)}\\\Big( \textbf{F} (j)+
\textbf{F} (i)/t_{sto_{out}}(i,HeatLowTDHN)  \Big)\\\geq
\%_{Peak_{sh}} \max_{h\in H,td\in TD}  \big\{ \textbf{EndUses}(HeatLowTDHN,h,td) \big\}\end{aligned}\end{align} \]</div>
<div class="math notranslate nohighlight" id="equation-eq-sc-peak">
<span class="eqno">(36)<a class="headerlink" href="#equation-eq-sc-peak" title="Link to this equation"></a></span>\[ \begin{align}\begin{aligned}\textbf{F} (j)
\geq
\%_{Peak_{sc}}\max_{h\in H,td\in TD}\left\{\textbf{F}_\textbf{t}(j,h,td)\right\}\\\forall j \in \text{TECH OF  EUT} (SpaceCooling)\end{aligned}\end{align} \]</div>
<p>Finally,
Eqs. <a class="reference internal" href="#equation-eq-dec-peak">(34)</a> - <a class="reference internal" href="#equation-eq-dhn-peak">(35)</a>
constrain the installed capacity of low temperature heat supply. Based
on the selected TDs, the ratio between the yearly peak demand and the
TDs peak demand is defined for space heating (<span class="math notranslate nohighlight">\(\%_{Peak_{sh}}\)</span>).
Eq. <a class="reference internal" href="#equation-eq-dec-peak">(34)</a> imposes that the installed
capacity for decentralised technologies covers the real peak over the
year. Similarly, Eq. <a class="reference internal" href="#equation-eq-dhn-peak">(35)</a> forces the
centralised heating system to have a supply capacity (production plus
storage) higher than the peak demand. These equations force the
installed capacity to meet the peak heating demand, i.e. which
represents, somehow, the network adequacy  <a class="footnote-reference brackets" href="#id58" id="id43" role="doc-noteref"><span class="fn-bracket">[</span>11<span class="fn-bracket">]</span></a>.
Similarly to <a class="reference internal" href="#equation-eq-dec-peak">(34)</a>, <a class="reference internal" href="#equation-eq-sc-peak">(36)</a> imposes that
the installed capacity for space cooling technologies covers the real
peak cooling demand over the year.</p>
</section>
<section id="adaptations-for-the-case-study">
<span id="sssec-lp-adaptation-case-study"></span><h4>Adaptations for the case study<a class="headerlink" href="#adaptations-for-the-case-study" title="Link to this heading"></a></h4>
<p>Additional constraints are required to implement scenarios. Scenarios
require six additional constraints
(Eqs. <a class="reference internal" href="#equation-eq-limitgwp">(37)</a> - <a class="reference internal" href="#equation-eq-solararealandlimited">(52)</a>)
to impose a limit on the GWP emissions, the minimum share of RE primary
energy, the relative shares of technologies, such as gasoline cars in
the private mobility, the cost of energy efficiency measures, the
electricity import power capacity and the available surface area for
solar technologies.</p>
<div class="math notranslate nohighlight" id="equation-eq-limitgwp">
<span class="eqno">(37)<a class="headerlink" href="#equation-eq-limitgwp" title="Link to this equation"></a></span>\[\textbf{GWP}_\textbf{tot} \leq gwp_{limit}\]</div>
<div class="math notranslate nohighlight" id="equation-eq-limitre">
<span class="eqno">(38)<a class="headerlink" href="#equation-eq-limitre" title="Link to this equation"></a></span>\[ \begin{align}\begin{aligned}\sum_{j \in  \text{RES}_\text{re},t \in T| \{h,td\} \in T\_H\_TD(t)} \textbf{F}_\textbf{t}(j,h,td)  \cdot  t_{op} (h,td)\\\geq
re_{share} \sum_{j \in \text{RES} ,t \in T| \{h,td\} \in T\_H\_TD(t)} \textbf{F}_\textbf{t}(j,h,td) \cdot  t_{op} (h,td)\end{aligned}\end{align} \]</div>
<p>To force the energy system to decrease its emissions, two lever
can constraint the annual emissions:
Eq. <a class="reference internal" href="#equation-eq-limitgwp">(37)</a> imposes a maximum yearly
emissions threshold on the GWP (<span class="math notranslate nohighlight">\(gwp_{limit}\)</span>); and
Eq. <a class="reference internal" href="#equation-eq-limitre">(38)</a> fixes the minimum renewable primary
energy share.</p>
<div class="math notranslate nohighlight" id="equation-eq-fmin-max-perc">
<span class="eqno">(39)<a class="headerlink" href="#equation-eq-fmin-max-perc" title="Link to this equation"></a></span>\[ \begin{align}\begin{aligned}f_{\text{min,%}}(j) \sum_{j' \in \text{TECH OF EUT} (eut),t \in T|\{h,td\} \in T\_H\_TD(t)}    \textbf{F}_\textbf{t}(j',h,td)\cdot t_{op}(h,td)\\\leq
    \sum_{t \in T|\{h,td\} \in T\_H\_TD(t)}  \textbf{F}_\textbf{t} (j,h,td)\cdot t_{op}(h,td)\\\leq
f_{\text{max,%}}(j) \sum_{j'' \in \text{TECH OF EUT} (eut),t \in T|\{h,td\} \in T\_H\_TD(t)}    \textbf{F}_\textbf{t}(j'',h,td)\cdot t_{op}(h,td)\\\forall eut \in EUT, \forall j \in \text{TECH OF EUT} (eut)\end{aligned}\end{align} \]</div>
<p>To represent the national energy system under study,
Eq. <a class="reference internal" href="#equation-eq-fmin-max-perc">(39)</a> imposes the relative
share of a technology in its sector.
Eq. <a class="reference internal" href="#equation-eq-fmin-max-perc">(39)</a> is complementary to
Eq. <a class="reference internal" href="#equation-eq-fmin-fmax">(9)</a>, as it expresses the minimum
(<span class="math notranslate nohighlight">\(f_{min,\%}\)</span>) and maximum (<span class="math notranslate nohighlight">\(f_{max,\%}\)</span>) yearly output shares of each
technology for each type of EUD. In fact, for a given technology,
assigning a relative share (e.g. boilers providing at least a given
percentage of the total heat demand) is more intuitive and close to the
energy planning practice than limiting its installed size. <span class="math notranslate nohighlight">\(f_{min,\%}\)</span>
and <span class="math notranslate nohighlight">\(f_{max,\%}\)</span> are fixed to 0 and 1, respectively, unless otherwise
indicated.</p>
<div class="math notranslate nohighlight" id="equation-eq-f-max-perc-motorcycle">
<span class="eqno">(40)<a class="headerlink" href="#equation-eq-f-max-perc-motorcycle" title="Link to this equation"></a></span>\[\begin{split}\sum_{t \in T|\{h,td\} \in T\_H\_TD(t)} \big(\textbf{F}_\textbf{t}(Motorcycle,h,td)
+ \textbf{F}_\textbf{t}(Motorcycle~Electric,h,td)\big) \cdot t_{op}(h,td) \\
\leq \%_{max,motorcycle}~\sum_{j \in \text{TECH OF EUT} (Mob~Private), t \in T|\{h,td\} \in T\_H\_TD(t)} \textbf{F}_\textbf{t}(j,h,td)\cdot t_{op}(h,td)\end{split}\]</div>
<p>Similarly to eq. <a class="reference internal" href="#equation-eq-fmin-max-perc">(39)</a>, eq. <a class="reference internal" href="#equation-eq-f-max-perc-motorcycle">(40)</a> imposes the maximum share of private passenger mobility that can be supplied by motorcycles.</p>
<div class="math notranslate nohighlight" id="equation-eq-efficiency">
<span class="eqno">(41)<a class="headerlink" href="#equation-eq-efficiency" title="Link to this equation"></a></span>\[\textbf{F}(Efficiency) =  \frac{1}{1+i_{rate}}\]</div>
<p>To account for efficiency measures from today to the target year,
Eq. <a class="reference internal" href="#equation-eq-efficiency">(41)</a> imposes their cost. The EUD
is based on a scenario detailed in
<a class="reference external" href="#sec:app1_end_uses">Data for end use demand</a> and has a lower energy demand
than the “business as usual” scenario, which has the highest energy
demand. Hence, the energy efficiency cost accounts for all the
investment required to decrease the demand from the “business as usual”
scenario and the implemented one. As the reduced demand is imposed over
the year, the required investments must be completed before this year.
Therefore, the annualisation cost has to be deducted from one year. This
mathematically implies to define the capacity of efficiency measures
deployed to <span class="math notranslate nohighlight">\(1/ (1+i_{rate})\)</span> rather than 1. The investment is
already expressed in €<sub>2015</sub>.</p>
</section>
<section id="additional-contraints-on-imports-exports-and-renewables">
<span id="sssec-lp-imports-exports-renewables"></span><h4>Additional contraints on imports, exports and renewables<a class="headerlink" href="#additional-contraints-on-imports-exports-and-renewables" title="Link to this heading"></a></h4>
<div class="math notranslate nohighlight" id="equation-eq-elecimplimited">
<span class="eqno">(42)<a class="headerlink" href="#equation-eq-elecimplimited" title="Link to this equation"></a></span>\[\textbf{F}_{\textbf{t}}(Electricity,h,td) \leq  elec_{import,max} + \textbf{F}(HVAC~Line) ~~~~~~ \forall h \in H, \forall td \in TD\]</div>
<div class="math notranslate nohighlight" id="equation-eq-elecexplimited">
<span class="eqno">(43)<a class="headerlink" href="#equation-eq-elecexplimited" title="Link to this equation"></a></span>\[\textbf{F}_{\textbf{t}}(Elec~Export,h,td) \leq  elec_{export,max} + \textbf{F}(HVAC~Line) ~~~~~~ \forall h \in H, \forall td \in TD\]</div>
<div class="math notranslate nohighlight" id="equation-eq-import-resources-constant">
<span class="eqno">(44)<a class="headerlink" href="#equation-eq-import-resources-constant" title="Link to this equation"></a></span>\[\textbf{F}_{\textbf{t}}(i,h,td) \cdot t_{op} (h,td) =  \textbf{Import}_{\textbf{constant}}(i) ~~~~~~ \forall i \in \text{RES~IMPORT~CONSTANT}, h \in H, td \in TD\]</div>
<div class="math notranslate nohighlight" id="equation-eq-export-efuels-constant">
<span class="eqno">(45)<a class="headerlink" href="#equation-eq-export-efuels-constant" title="Link to this equation"></a></span>\[\textbf{F}_{\textbf{t}}(i,h,td) \cdot t_{op} (h,td) =  \textbf{Export}_{\textbf{constant}}(i) ~~~~~~ \forall i \in \text{EXPORT~E~FUEL}, h \in H, td \in TD\]</div>
<p>Eqs. <a class="reference internal" href="#equation-eq-elecimplimited">(42)</a> and <a class="reference internal" href="#equation-eq-elecexplimited">(43)</a> limit the power grid
import and export capacity from/to neighbouring countries, based on the 2021 import/export capacity plus the construction of new High-Voltage transfer capacity (HVAC Line). Eq. <a class="reference internal" href="#equation-eq-import-resources-constant">(44)</a> imposes that some resources are imported at a constant power. For example, gas and hydrogen are supposed to be imported at a constant flow during the year. In addition to offering a more realistic representation, this implementation makes it possible to visualise the level of storage within the region. Eq. <a class="reference internal" href="#equation-eq-export-efuels-constant">(45)</a> imposes the same constraint as <a class="reference internal" href="#equation-eq-import-resources-constant">(44)</a>, but for the <em>export</em> of e-fuels.</p>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>Adding too many ressource to Eq. <a class="reference internal" href="#equation-eq-import-resources-constant">(44)</a> increases drastically the computational time.
In this implementation, only resources expensive to store have been accounted for i.e. hydrogen and gas.
Other resources, such as diesel or ammonia, can be stored at a cheap price with small losses.
By limiting EXPORT-E-FUEL to two types of resources (hydrogen and gas), the computation time is below a minute.
When adding all imported resources to EXPORT-E-FUEL, the computational time becomes above 6 minutes.</p>
</div>
<div class="math notranslate nohighlight" id="equation-eq-link-dam-storage-to-hydro-dam">
<span class="eqno">(46)<a class="headerlink" href="#equation-eq-link-dam-storage-to-hydro-dam" title="Link to this equation"></a></span>\[\frac{\textbf{F}(Dam~Storage) - f_{min}(Dam~Storage)}{f_{max}(Dam~Storage) - f_{min}(Dam~Storage)} \leq \frac{\textbf{F}(Hydro~Dam) - f_{min}(Hydro~Dam)}{f_{max}(Hydro~Dam) - f_{min}(Hydro~Dam)}\]</div>
<div class="math notranslate nohighlight" id="equation-eq-dam-storage-in">
<span class="eqno">(47)<a class="headerlink" href="#equation-eq-dam-storage-in" title="Link to this equation"></a></span>\[\textbf{Sto}_\textbf{in}(Dam~Storage,Electricity,h,td) = \textbf{F}_{\textbf{t}}(Hydro~Dam,h,td) ~~~~~~ \forall h \in H, \forall td \in TD\]</div>
<div class="math notranslate nohighlight" id="equation-eq-dam-storage-out">
<span class="eqno">(48)<a class="headerlink" href="#equation-eq-dam-storage-out" title="Link to this equation"></a></span>\[\textbf{Sto}_\textbf{out}(Dam~Storage,Electricity,h,td) \leq \textbf{F}(Hydro~Dam,h,td) ~~~~~~ \forall h \in H, \forall td \in TD\]</div>
<p>In EnergyScope, there are two technologies related to hydro-electric dams: <em>Hydro Dam</em> and <em>Dam Storage</em>. The former relates to the electricity production function of hydro-electric dams, while the second relates to their storage function. These two functions are defined as separate technologies in EnergyScope, but of course they relate to the same physical asset. The constraints defined in eqs <a class="reference internal" href="#equation-eq-link-dam-storage-to-hydro-dam">(46)</a> - <a class="reference internal" href="#equation-eq-dam-storage-out">(48)</a> hence bind these two technologies to each other. First, eq. <a class="reference internal" href="#equation-eq-link-dam-storage-to-hydro-dam">(46)</a> imposes that the installed capacity of both technnologies must remain proportional to each other, in the proportions defined by their respective input parameters <span class="math notranslate nohighlight">\(f_{min}\)</span> and <span class="math notranslate nohighlight">\(f_{max}\)</span>. (Note that to improve readability, eq. <a class="reference internal" href="#equation-eq-link-dam-storage-to-hydro-dam">(46)</a> has been written in a non-linear fashion in this documentation. The equation is linear in the actual model’s code). Second, eq. <a class="reference internal" href="#equation-eq-dam-storage-in">(47)</a> imposes that all electricity produced by <em>Hydro Dam</em> is immediately absorbed by <em>Dam Storage</em>. This electricity is then released by <em>Dam Storage</em>, under the constraint that the maximum electricity production of <em>Dam Storage</em> is the same one as for <em>Hydro Dam</em>.</p>
<div class="math notranslate nohighlight" id="equation-eq-limit-solar-mulitple-st">
<span class="eqno">(49)<a class="headerlink" href="#equation-eq-limit-solar-mulitple-st" title="Link to this equation"></a></span>\[-\frac{\textbf{F}(ST~Collector)}{f(ST~Power~Block, ST~Heat)} \leq sm_{max} \cdot \textbf{F}(ST~Power~Block)\]</div>
<div class="math notranslate nohighlight" id="equation-eq-limit-solar-mulitple-pt">
<span class="eqno">(50)<a class="headerlink" href="#equation-eq-limit-solar-mulitple-pt" title="Link to this equation"></a></span>\[-\frac{\textbf{F}(PT~Collector)}{f(PT~Power~Block, PT~Heat)} \leq sm_{max} \cdot \textbf{F}(PT~Power~Block)\]</div>
<p>Concentrated solar power (CSP) technologies are modelled with 3 elements: <em>Collectors</em>, <em>Storage</em> and <em>Power Block</em>.
The link between the 3 elements is kept into a “realistic” range thanks to Equations
<a class="reference internal" href="#equation-eq-limit-solar-mulitple-st">(49)</a> and <a class="reference internal" href="#equation-eq-limit-solar-mulitple-pt">(50)</a>.</p>
<div class="math notranslate nohighlight" id="equation-eq-solararearooftoplimited">
<span class="eqno">(51)<a class="headerlink" href="#equation-eq-solararearooftoplimited" title="Link to this equation"></a></span>\[\frac{\textbf{F}(PV~Rooftop)}{power\_density_{pv}} + \frac{\textbf{F}(Dec_{Solar}) + \textbf{F}(DHN_{Solar})}{power\_density_{solar~thermal}}  \leq solar_{area,rooftop}\]</div>
<div class="math notranslate nohighlight" id="equation-eq-solararealandlimited">
<span class="eqno">(52)<a class="headerlink" href="#equation-eq-solararealandlimited" title="Link to this equation"></a></span>\[\begin{split}\frac{\textbf{F}(PV~Utility)}{power\_density_{pv}} - \frac{\textbf{F}(ST~Collector) \cdot f(ST~Power~Block, ST~Heat)}{power\_density_{csp}}\\
- \frac{\textbf{F}(PT~Collector) \cdot f(PT~Power~Block, PT~Heat)}{power\_density_{csp}}  \leq solar_{area,ground}\end{split}\]</div>
<div class="math notranslate nohighlight" id="equation-eq-solarareagroundhighirrlimited">
<span class="eqno">(53)<a class="headerlink" href="#equation-eq-solarareagroundhighirrlimited" title="Link to this equation"></a></span>\[\begin{split}- \frac{\textbf{F}(ST~Collector) \cdot f(ST~Power~Block, ST~Heat)}{power\_density_{csp}}\\
- \frac{\textbf{F}(PT~Collector) \cdot f(PT~Power~Block, PT~Heat)}{power\_density_{csp}}  \leq solar_{area,ground,high~irr}\end{split}\]</div>
<p>In this version of EnergyScope, the upper limit for the deployment of solar technologies is
calculated based on the available areas (<span class="math notranslate nohighlight">\(solar_{area}\)</span>) and power
densities (<span class="math notranslate nohighlight">\(power\_density\)</span>) of solar technologies. The conversion factor
between an installed capacity (in watt peak (Wp)) and the surface used (in
<span class="math notranslate nohighlight">\(km^2\)</span>) is calculated based on the peak power density (in [Wp/m<span class="math notranslate nohighlight">\(^2\)</span>]).
Put simply, the peak power density represents the peak power of one square meter of
solar panel. Thus, the land use of a solar technology is its installed capacity
(<span class="math notranslate nohighlight">\(\textbf{F}(\cdot)\)</span>, in [GW]) divided by its power peak density  (in [GW/km<span class="math notranslate nohighlight">\(^2\)</span>]).
Eq. <a class="reference internal" href="#equation-eq-solararearooftoplimited">(51)</a> imposes a constraint on the available rooftop area for solar energy.
Eq. <a class="reference internal" href="#equation-eq-solararealandlimited">(52)</a>, does the same for ground area. Finally, eq. <a class="reference internal" href="#equation-eq-solarareagroundhighirrlimited">(53)</a>
proceeds similarly for ground area with high irradiation, suitable for the installation of CSP plants
(i.e. with a Direct Normal Irradiation (DNI) superior to 1800 [kWh/m<span class="math notranslate nohighlight">\(^2\)</span>/year]).
The area limitation is applied on the <em>Collector</em> element of the CSP. This constraint is then transferred to
<em>Storage</em> and <em>Power Block</em>, namely via eqs <a class="reference internal" href="#equation-eq-limit-solar-mulitple-st">(49)</a> and <a class="reference internal" href="#equation-eq-limit-solar-mulitple-pt">(50)</a>.
Note that in eqs. <a class="reference internal" href="#equation-eq-solararealandlimited">(52)</a> - <a class="reference internal" href="#equation-eq-solarareagroundhighirrlimited">(53)</a>, the terms associated
to CSP are counted as positive (the minus signs are present to compensate for the negative signs of <span class="math notranslate nohighlight">\(f(\cdot)\)</span>).</p>
</section>
</section>
</section>
<section id="implementation">
<span id="ssec-estd-implementation"></span><h2>Implementation<a class="headerlink" href="#implementation" title="Link to this heading"></a></h2>
<p>The implementation into code of the MILP and LP problems has been carried out using
an algebraic modelling language. Such modelling language allows for the representation of
large LP and MILP problems. Its syntax is similar to AMPL, which is -
according to the NEOS-statistics <a class="footnote-reference brackets" href="#id61" id="id44" role="doc-noteref"><span class="fn-bracket">[</span>12<span class="fn-bracket">]</span></a> - the most popular format for
representing mathematical programming problems. The chosen formulation enables
the use of different solvers, be it open source ones (e.g. GLPK) or
commercial ones (e.g. CPLEX, Gurobi). Each of the equations defined in
this documentation is found in identical form in the code,
together with the corresponding numbering. SETS, Variables and parameters
have the same names (unless explicitly stated in the definition of the term).
<a class="reference internal" href="#fig-ch2-lp-formulation-implementation-colored"><span class="std std-numref">Figure 13</span></a>
illustrates, for the balance constraint <a class="reference internal" href="#equation-eq-layer-balance">(13)</a>, the mathematical
formulation presented in this work and its implementation in the code.
Colors highlight corresponding elements. In the code, each
constraint has a comment (starting with #) and a name (colored in
black), in this case <em>layer_balance</em>. In addition, most of the SETS,
Variables and parameters are more explicitly named in the code. For example,
the set “layers” is named <em>L</em> in the documentation and <em>LAYERS</em> in the
code; similarly, the input efficiency is named
<em>f</em> in the documentation and <em>layers_in_out</em> in the code.</p>
<figure class="align-default">
<img alt="Comparison of equation formulation and code. This is the equation" src="../_images/eqs_color.png" />
</figure>
<figure class="align-default" id="fig-ch2-lp-formulation-implementation-colored">
<img alt="Comparison of equation formulation and code." src="../_images/ch_estd_code_screenshot.png" />
<figcaption>
<p><span class="caption-number">Fig. 13 </span><span class="caption-text">Comparison of equations’ formulation in this documentation (upper) and in the code
(lower). Example based on Eq. <a class="reference internal" href="#equation-eq-layer-balance">(13)</a>.</span><a class="headerlink" href="#fig-ch2-lp-formulation-implementation-colored" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>The entire implementation is available on the directory
<span id="id45"><sup><a class="reference internal" href="Bibliography.html#id66" title="Gauthier Limpens. v2.1 Updated version of EnergyScope TD for Belgian application. URL: https://github.com/energyscope/EnergyScope/tree/v2.1.">38</a></sup></span> and its architecture is illustrated
in <a class="reference internal" href="#fig-ch2-estd-repo-structure"><span class="std std-numref">Figure 14</span></a>. Four folders compose
the repository and contain the documentation (<code class="docutils literal notranslate"><span class="pre">Documentation</span></code>), the
data used (<code class="docutils literal notranslate"><span class="pre">Data_management</span></code>), the MILP implementation
(<code class="docutils literal notranslate"><span class="pre">STEP_1_TD_selection</span></code>) and the LP implementation
(<code class="docutils literal notranslate"><span class="pre">STEP_2_Energy_Model</span></code>). For each of the models, the definition of the
terms (SETS, Variables and Parameters) as well as the domains of the
variables, the formulation of the constraints and the objective function
are included in the model file (with the extension <code class="docutils literal notranslate"><span class="pre">.mod</span></code>). The
numerical values of the parameters are contained in separate files (with
the extension <code class="docutils literal notranslate"><span class="pre">.dat</span></code>). Finally, the output data of the model are saved
in a file (wit the extension <code class="docutils literal notranslate"><span class="pre">.out</span></code>) or a folder (<code class="docutils literal notranslate"><span class="pre">\outputs</span></code>). An
interface - via excel - allows to visualise the data (<code class="docutils literal notranslate"><span class="pre">DATA.xlsx</span></code>) and
to generate the data files (<code class="docutils literal notranslate"><span class="pre">STEP_1_in.xlsx</span></code>, <code class="docutils literal notranslate"><span class="pre">STEP_1_out.xlsx</span></code> and
<code class="docutils literal notranslate"><span class="pre">STEP_2_in.xlsx</span></code>). Finally, a user guide manual is available in the
documentation to support the modeler in her/his first steps.</p>
<figure class="align-default" id="fig-ch2-estd-repo-structure">
<img alt="EnergyScope TD repository structure." src="../_images/ch_estd_repo_structure.png" />
<figcaption>
<p><span class="caption-number">Fig. 14 </span><span class="caption-text">EnergyScope TD repository structure available at
<span id="id46"><sup><a class="reference internal" href="Bibliography.html#id66" title="Gauthier Limpens. v2.1 Updated version of EnergyScope TD for Belgian application. URL: https://github.com/energyscope/EnergyScope/tree/v2.1.">38</a></sup></span>.</span><a class="headerlink" href="#fig-ch2-estd-repo-structure" title="Link to this image"></a></p>
</figcaption>
</figure>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id47" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id13">1</a><span class="fn-bracket">]</span></span>
<p>Air passenger transport is accounted for in passenger mobility (excluding international flights).</p>
</aside>
<aside class="footnote brackets" id="id48" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id18">2</a><span class="fn-bracket">]</span></span>
<p>Hydrogen can be produced based on many feedstocks, among which electricity via the use of electrolysers.</p>
</aside>
<aside class="footnote brackets" id="id49" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id35">3</a><span class="fn-bracket">]</span></span>
<p>Indeed, some technologies have several outputs, such as a CHP. Thus,
the installed size must be defined with respect to one of these
outputs. For example, CHP are defined based on the thermal output
rather than the electrical one.</p>
</aside>
<aside class="footnote brackets" id="id50" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id36">4</a><span class="fn-bracket">]</span></span>
<p>To simplify the reading, the formulation
<span class="math notranslate nohighlight">\(t \in T| \{h,td\} \in T\_H\_TD(t)\)</span> is used. However, this
cannot be directly implemented in the code and it requires two
additional sets : <span class="math notranslate nohighlight">\(HOUR\_OF\_PERIOD(t)\)</span> and
<span class="math notranslate nohighlight">\(TYPICAL\_DAY\_OF\_PERIOD(t)\)</span>. Hence, we have:
<span class="math notranslate nohighlight">\(t \in T| \{h,td\} \in T\_H\_TD(t)\)</span>, which is equivalent in the
code to
<span class="math notranslate nohighlight">\(t \in T| h \in HOUR\_OF\_PERIOD(t), td \in TYPICAL\_DAY\_OF\_PERIOD(t)\)</span>.</p>
</aside>
<aside class="footnote brackets" id="id51" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id37">5</a><span class="fn-bracket">]</span></span>
<p>In most cases, the activation of the constraint stated in
Eq. <a class="reference internal" href="#equation-eq-sto-level">(14)</a> will have as a consequence
that the level of storage be the same at the beginning and at the end
of each day — hence the use of the terminology ‘<em>daily storage</em>’.
Note, however, that such daily storage behaviour is not always
guaranteed by this constraint and thus, depending on the typical days
sequence, a daily storage behaviour might need to be explicitly
enforced.</p>
</aside>
<aside class="footnote brackets" id="id52" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id38">6</a><span class="fn-bracket">]</span></span>
<p>In the code, these equations are implemented with a <em>if-then</em>
statement.</p>
</aside>
<aside class="footnote brackets" id="id53" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id39">7</a><span class="fn-bracket">]</span></span>
<p>In this linear formulation, storage technologies can charge and
discharge at the same time. On the one hand, this avoids the need of
integer variables; on the other hand, it has no physical meaning.
However, in a cost minimization problem, the cheapest solution
identified by the solver will always choose to either charge or
discharge at any given <span class="math notranslate nohighlight">\(t\)</span>, as long as cost and efficiencies
are defined. Hence, we recommend to always verify numerically the
fact that only storage inputs or outputs are activated at each
<span class="math notranslate nohighlight">\(t\)</span>, as we do in all our implementations.</p>
</aside>
<aside class="footnote brackets" id="id54" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id40">8</a><span class="fn-bracket">]</span></span>
<p>This is the ratio between the losses in the grid and the total annual
electricity production in Belgium in 2015
<span id="id55"><sup><a class="reference internal" href="Bibliography.html#id67" title="European Commission - Eurostat. Statistical pocketbook 2017. Technical Report 4, European Commission - Eurostat., 2017. doi:10.2832/147440.">39</a></sup></span>.</p>
</aside>
<aside class="footnote brackets" id="id56" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id41">9</a><span class="fn-bracket">]</span></span>
<p>[foot:nonLinear]All equations expressed in a compact non-linear form
in this section Eqs. <a class="reference internal" href="#equation-eq-mob-share-fix">(24)</a>, <a class="reference internal" href="#equation-eq-freight-share-fix">(25)</a>,
<a class="reference internal" href="#equation-eq-heat-decen-share">(29)</a> and <a class="reference internal" href="#equation-eq-dhn-peak">(35)</a> can be linearised. For these
cases, the <strong>EndUses</strong> is defined with parameters and a variable
representing a constant share over the year (e.g.  <span class="math notranslate nohighlight">\(\textbf{%}_\textbf{public}\)</span>). As
an example, <strong>EndUses</strong> in
Eq. <a class="reference internal" href="#equation-eq-mob-share-fix">(24)</a> is equal to
<span class="math notranslate nohighlight">\(\textbf{EndUsesInput}(PassMb) \cdot %pass (h, td) / t_op (h, td)\)</span>.
The term <span class="math notranslate nohighlight">\(\textbf{%}_{\textbf{public}}\)</span>, is missing in the equation, but is implicitly
implemented in <span class="math notranslate nohighlight">\(\textbf{%}_{\textbf{PassMob}}\)</span>.</p>
</aside>
<aside class="footnote brackets" id="id57" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id42">10</a><span class="fn-bracket">]</span></span>
<p>This generation (ZE0) was marketed from 2010 to 2017 with a battery
capacity of 24 kWh. The new generation (ZE1) accounts for an improved
capacity and reaches 40 kWh per battery. Data from
<a class="reference external" href="https://en.wikipedia.org/wiki/Nissan_Leaf">https://en.wikipedia.org/wiki/Nissan_Leaf</a>, consulted on 08-02-2021</p>
</aside>
<aside class="footnote brackets" id="id58" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id43">11</a><span class="fn-bracket">]</span></span>
<p>The model resolution of the dispatch is not accurate enough to verify
the adequacy. As one model cannot address all the issues, another
approach has been preferred: couple the model to a dispatch one, and
iterate between them. Percy and Coates
<span id="id59"><sup><a class="reference internal" href="Bibliography.html#id68" title="Damon Coates and Guillaume Percy. Energy models coupling: soft-link between a long-term planning model and a dispatch model (energyscope td - dispa-set). Master's thesis, UCLouvain, 2020. URL: http://hdl.handle.net/2078.1/thesis:25205.">40</a></sup></span> demonstrated the
feasibility of coupling a design model (ESTD) with a dispatch one
(Dispa-SET <span id="id60"><sup><a class="reference internal" href="Bibliography.html#id69" title="Sylvain Quoilin, Ignacio Hidalgo Gonzalez, and Andreas Zucker. JRC TECHNICAL REPORTS Modelling Future EU Power Systems Under High Shares of Renewables. Technical Report, European Union, 2017. doi:10.2760/25400.">41</a></sup></span>). Based on a feedback
loop, they iterated on the design to verify the power grid adequacy
and the strategic reserves. Results show that the backup capacities
and storage needed to be slightly increased compared to the results
of the design model alone.</p>
</aside>
</aside>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id61" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id44">12</a><span class="fn-bracket">]</span></span>
<p>NEOS Server is an Internet-based client-server application that
provides free access to a library of optimization solvers. Statistics
are available at: <a class="reference external" href="https://neos-server.org/neos/report.html">https://neos-server.org/neos/report.html</a>, consulted
the 27/01/2021.</p>
</aside>
</aside>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="How%20to%20contribute.html" class="btn btn-neutral float-left" title="How to contribute" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="Input%20Data%20-%20Colombia.html" class="btn btn-neutral float-right" title="Input Data - Colombia" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, G. Limpens.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>